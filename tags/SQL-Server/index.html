<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>標籤: SQL Server | kyosora 虛空筆記</title><meta name="author" content="kyosora"><meta name="copyright" content="kyosora"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="個人技術筆記和學習心得分享">
<meta property="og:type" content="website">
<meta property="og:title" content="kyosora 虛空筆記">
<meta property="og:url" content="https://kyosora.github.io/tags/SQL-Server/">
<meta property="og:site_name" content="kyosora 虛空筆記">
<meta property="og:description" content="個人技術筆記和學習心得分享">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://kyosora.github.io/img/butterfly-icon.png">
<meta property="article:author" content="kyosora">
<meta property="article:tag" content="網路安全, 系統管理, 程式設計, 技術筆記">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://kyosora.github.io/img/butterfly-icon.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://kyosora.github.io/tags/SQL-Server/"><link rel="preconnect" href="https://jsd.012700.xyz"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><meta name="google-site-verification" content="NdIUXAOVyGnnBhcrip0ksCawbdAzT0hlBZDE9u4jx6k"/><meta name="msvalidate.01" content="567E47D75E8DCF1282B9623AD914701E"/><meta name="baidu-site-verification" content="code-pE5rnuxcfD"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://jsd.012700.xyz/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://jsd.012700.xyz/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到符合您查詢的內容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: '複製成功',
    error: '複製失敗',
    noSupport: '瀏覽器不支援'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '剛剛',
    min: '分鐘前',
    hour: '小時前',
    day: '天前',
    month: '個月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: kyosora","link":"連結: ","source":"來源: kyosora 虛空筆記","info":"著作權歸作者所有。如需商業轉載，請聯絡作者獲得授權，非商業轉載請註明出處。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://jsd.012700.xyz/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '載入更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '標籤: SQL Server',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'tag'
}</script><link rel="preconnect" href="https://jsd.012700.xyz"><link href="/self/btf.css" rel="stylesheet"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "/img/loading.gif" data-lazy-src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">99</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">118</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">32</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 頁面</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 歸檔</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 圖庫</span></a></li><li><a class="site-page child" href="/talking/"><i class="fa-fw fas fa-comment-dots"></i><span> 說說</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 示例</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文檔</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> 🚀 快速開始</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> 📑 主題頁面</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> 🛠 主題配置</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> ⚔️ 標簽外挂</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> ❓ 主題問答</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> ⚡️ 進階教程</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> ✨ 更新日誌</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> 語言</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div></div></div><div class="page" id="body-wrap"><header class="not-home-page" id="page-header" style="background-image: url(https://oss.012700.xyz/butterfly/2024/10/tag.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">kyosora 虛空筆記</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜尋</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 頁面</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 歸檔</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 圖庫</span></a></li><li><a class="site-page child" href="/talking/"><i class="fa-fw fas fa-comment-dots"></i><span> 說說</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 示例</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文檔</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/posts/21cfbf15/"><span> 🚀 快速開始</span></a></li><li><a class="site-page child" href="/posts/dc584b87/"><span> 📑 主題頁面</span></a></li><li><a class="site-page child" href="/posts/4aa8abbe/"><span> 🛠 主題配置</span></a></li><li><a class="site-page child" href="/posts/ceeb73f/"><span> ⚔️ 標簽外挂</span></a></li><li><a class="site-page child" href="/posts/98d20436/"><span> ❓ 主題問答</span></a></li><li><a class="site-page child" href="/posts/4073eda/"><span> ⚡️ 進階教程</span></a></li><li><a class="site-page child" href="/posts/198a4240/"><span> ✨ 更新日誌</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-language"></i><span> 語言</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="/"><i class="fa-fw fas fa-c"></i><span> 中文</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="page-site-info"><h1 id="site-title">SQL Server</h1></div></header><main class="layout" id="content-inner"><div class="recent-posts nc" id="recent-posts"><div class="recent-post-items"><div class="recent-post-item"><div class="post_cover left"><a href="/posts/undefined/" title="SQL Server資料庫加密實戰:透明資料加密(TDE)完整實作指南"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL Server資料庫加密實戰:透明資料加密(TDE)完整實作指南"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="SQL Server資料庫加密實戰:透明資料加密(TDE)完整實作指南">SQL Server資料庫加密實戰:透明資料加密(TDE)完整實作指南</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-12-20T10:43:00.000Z" title="發表於 2024-12-20 18:43:00">2024-12-20</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB/">資料庫</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/">資訊安全</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 隨著資安事件頻傳,如何保護資料庫中的敏感資料成為當前的重要課題。Microsoft SQL Server提供的透明資料加密(Transparent Data Encryption, TDE)是一個強大的解決方案,它能夠在資料寫入磁碟時自動加密,讀取時自動解密,對應用程式完全透明。本文將帶您一步步實作TDE,並深入探討其運作原理。 TDE運作原理 TDE的主要目的是保護資料庫檔案(.mdf、.ldf)中的靜態資料。當資料要寫入磁碟時,TDE會自動進行加密;當需要讀取資料時,則會自動解密。整個過程對應用程式來說是完全透明的,不需要修改任何程式碼。 以下是TDE的運作流程:                          資料庫檔案               資料庫引擎               記憶體               資料庫加密金鑰               憑證                                                                                      加密    ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/undefined/" title="SQL Server CSV匯出終極攻略：3種工具效能實測，速度最高提升300%！"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL Server CSV匯出終極攻略：3種工具效能實測，速度最高提升300%！"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="SQL Server CSV匯出終極攻略：3種工具效能實測，速度最高提升300%！">SQL Server CSV匯出終極攻略：3種工具效能實測，速度最高提升300%！</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-12-17T10:10:09.000Z" title="發表於 2024-12-17 18:10:09">2024-12-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB%E7%AE%A1%E7%90%86/">資料庫管理</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 每個資料庫管理員都曾遇過這種情況：老闆說「我要這個報表，越快越好」，結果你發現要匯出的資料有好幾億筆… 別擔心！本篇文章將完整介紹SQL Server三大CSV匯出工具：SQLCMD、BCP和SSIS的實戰技巧。透過實際案例分析和效能測試，教你如何選擇最適合的工具，並運用最佳化技巧大幅提升匯出效能！ 三大工具特色比較   SQLCMD  優點：彈性高、容易整合自動化流程、指令碼管理方便 缺點：需要撰寫較多程式碼 適用場景：自動化排程作業、需要客製化處理的匯出工作    BCP (Bulk Copy Program)  優點：效能最佳、記憶體使用率低、適合大量資料處理 缺點：彈性較低、特殊資料處理較複雜 適用場景：大量資料快速匯出、簡單資料結構    SSIS (SQL Server Integration Services)  優點：視覺化設計、功能完整、整合性高 缺點：設定複雜、維護成本較高 適用場景：複雜ETL流程、需要資料轉換處理       SQL Server CSV匯出工具完整比較             SQLCMD     優點:     - 彈性高   ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/undefined/" title="SQL Server 資料庫管理必學秘技：快速查詢物件修改時間"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL Server 資料庫管理必學秘技：快速查詢物件修改時間"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="SQL Server 資料庫管理必學秘技：快速查詢物件修改時間">SQL Server 資料庫管理必學秘技：快速查詢物件修改時間</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-12-16T10:15:05.000Z" title="發表於 2024-12-16 18:15:05">2024-12-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB/">資料庫</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 在進行資料庫開發與維護時，經常需要知道資料表、檢視表或預存程序最後的修改時間。這些資訊對於：  追蹤系統變更 問題排除 效能調校 版本控制 都非常重要。本文將介紹幾個實用的SQL查詢技巧，讓你輕鬆掌握資料庫物件的時間資訊。  查詢資料表與檢視表的修改時間 以下是查詢資料表與檢視表修改時間的SQL： 12345678SELECT [name]           -- 物件名稱      ,create_date     -- 建立時間      ,modify_date     -- 修改時間      ,type_desc       -- 物件類型FROM sys.all_objects WHERE type_desc = &#x27;USER_TABLE&#x27;    -- 使用者資料表   OR type_desc = &#x27;VIEW&#x27;          -- 檢視表ORDER BY modify_date DESC         -- 依修改時間排序 查詢說明  sys.all_objects: SQL...</div></div></div><div class="recent-post-item ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-8919908724705274" data-ad-slot="1538867630"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/undefined/" title="SQL Server管理員必學：SQLCMD實戰指南"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL Server管理員必學：SQLCMD實戰指南"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="SQL Server管理員必學：SQLCMD實戰指南">SQL Server管理員必學：SQLCMD實戰指南</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-12-15T10:52:15.000Z" title="發表於 2024-12-15 18:52:15">2024-12-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB%E7%AE%A1%E7%90%86/">資料庫管理</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 在管理大型SQL Server資料庫時,你是否遇過以下痛點？  資料匯入匯出緩慢到讓人抓狂 維護作業需要人工執行,常常加班到半夜 大型資料庫備份還原總是出問題 跨伺服器操作複雜又容易出錯  別擔心！本篇完整剖析SQLCMD的所有實戰技巧,讓你輕鬆應對各種資料庫維運挑戰。無論你是資深DBA還是新手工程師,都能從中學到實用的技巧！    SQLCMD 功能與效能概觀      SQLCMD             資料匯入匯出     批次處理優化               執行SQL指令     效能監控               資料庫備份     壓縮優化               自動化排程     錯誤處理                大型資料庫匯入效能比較                              一般匯入     批次處理     最佳化設定     實戰經驗分享 案例一：10TB...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/undefined/" title="SQL Server管理員必學：SQLCMD完整應用指南"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL Server管理員必學：SQLCMD完整應用指南"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="SQL Server管理員必學：SQLCMD完整應用指南">SQL Server管理員必學：SQLCMD完整應用指南</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-12-14T10:28:35.000Z" title="發表於 2024-12-14 18:28:35">2024-12-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB%E7%AE%A1%E7%90%86/">資料庫管理</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 在管理大型SQL Server資料庫時,SQLCMD是一個不可或缺的命令列工具。無論是執行日常維護工作、資料匯入匯出,還是建立自動化作業,SQLCMD都能幫助我們更有效率地完成這些任務。本文將詳細介紹SQLCMD的各種應用方式,幫助你掌握這個強大的工具。    SQLCMD 功能概觀      SQLCMD             資料匯入匯出               執行SQL指令               資料庫備份               自動化排程          SQLCMD基本語法 SQLCMD的基本語法結構如下： 12345678sqlcmd -S &lt;伺服器名稱&gt;          -- 指定SQL Server執行個體-U &lt;使用者名稱&gt;          -- 指定登入帳號-P &lt;密碼&gt;                -- 指定密碼-d &lt;資料庫名稱&gt;          -- 指定要使用的資料庫-i &lt;輸入檔案&gt;            -- 指定要執行的SQL指令檔-o...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/undefined/" title="SQL Server管理技巧：批量更新資料的神奇小法術"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL Server管理技巧：批量更新資料的神奇小法術"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="SQL Server管理技巧：批量更新資料的神奇小法術">SQL Server管理技巧：批量更新資料的神奇小法術</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-12-13T10:53:00.000Z" title="發表於 2024-12-13 18:53:00">2024-12-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB/">資料庫</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 在管理資料庫時，我們經常會遇到需要在多個資料表中更新相同欄位的情況。例如：修改某個代碼、更新狀態值等。如果要手動找出所有包含該欄位的資料表並逐一更新，不只費時還容易出錯。今天就來分享一個實用的 SQL 技巧，教你如何快速找出並更新特定欄位！ 使用情境 假設我們需要將所有資料表中的 MaintainClassID 欄位從 4851204 更新為 4851206。在大型資料庫中，這個欄位可能分散在多個資料表中。如何一次找出所有包含此欄位的資料表呢？ 解決方案 我們可以利用 SQL Server 的 INFORMATION_SCHEMA 視圖來查詢資料庫結構，並產生所需的更新語句。讓我們一步步來看： 步驟一：找出所有包含特定欄位的資料表 12345678910111213-- 找到所有有該欄位的資料表SELECT DISTINCT    t.TABLE_SCHEMA, -- 資料表的架構名稱    t.TABLE_NAME   -- 資料表名稱FROM    INFORMATION_SCHEMA.COLUMNS c    INNER JOIN   ...</div></div></div><div class="recent-post-item ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-8919908724705274" data-ad-slot="1538867630"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/undefined/" title="【SQL Server密技】一次精通SELECT INTO批次建表，效能優化的絕佳解決方案！"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【SQL Server密技】一次精通SELECT INTO批次建表，效能優化的絕佳解決方案！"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="【SQL Server密技】一次精通SELECT INTO批次建表，效能優化的絕佳解決方案！">【SQL Server密技】一次精通SELECT INTO批次建表，效能優化的絕佳解決方案！</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-12-12T10:16:00.000Z" title="發表於 2024-12-12 18:16:00">2024-12-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB/">資料庫</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 在處理大型資料庫時，有時候我們需要將一個大型資料表的資料分割成多個較小的資料表，以提升查詢效能或方便資料管理。本文將介紹如何使用SQL Server的SELECT INTO搭配批次處理來實現這個目標。 SELECT INTO 的神奇魔力 SELECT INTO 是SQL Server提供的一個強大功能，它可以：  根據查詢結果直接建立新的資料表 自動複製資料表結構 自動將資料寫入新表           來源資料表      批次處理邏輯   每批500筆資料      資料表1      資料表2      資料表3      資料表4      資料表...                                            讀取原始資料   依據ROW_NUMBER()分批建立新資料表  程式碼詳解 讓我們來看看完整的程式碼： 1234567891011121314151617181920212223242526272829303132333435-- 宣告必要的變數DECLARE @StartRow INT,          --...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/undefined/" title="【踩雷分享】升級至 TLS 1.3 的注意事項 - 實戰經驗總整理"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【踩雷分享】升級至 TLS 1.3 的注意事項 - 實戰經驗總整理"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="【踩雷分享】升級至 TLS 1.3 的注意事項 - 實戰經驗總整理">【踩雷分享】升級至 TLS 1.3 的注意事項 - 實戰經驗總整理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-12-09T10:30:00.000Z" title="發表於 2024-12-09 18:30:00">2024-12-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/">資訊安全</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E7%B3%BB%E7%B5%B1%E7%AE%A1%E7%90%86/">系統管理</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 最近在處理資安弱點掃描時，常常收到建議「關閉 TLS 1.1 和 TLS 1.2，只開啟 TLS 1.3」的要求。這個改動看似簡單，但實際執行時可能會遇到很多意想不到的問題。本文將分享實戰經驗，幫助大家順利完成升級。 為什麼要升級到 TLS 1.3？ 資安考量  TLS 1.3 提供更強的加密演算法 移除了舊版本中不安全的加密方式 改善了握手過程的安全性  法規要求  新版 PCI DSS 要求使用 TLS 1.3 資安弱點掃描工具會標記較舊版本為風險 符合最新的安全標準  可能遇到的問題 1. 遠端桌面連線 (RDP) 問題  Windows Server 2016 之前的版本可能無法連線 需要安裝更新才能支援 TLS 1.3 舊版 RDP 客戶端可能完全無法使用  2. SQL Server 連線問題  SQL Server 2016 之前的版本預設不支援 TLS 1.3 連線字串可能需要調整 某些舊版管理工具可能無法連線  3. 應用程式相容性  部分舊版 .NET Framework 應用程式可能無法運作 Java 8 之前的版本不支援 TLS...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/undefined/" title="資料庫連線池爆掉救火秘笈！如何優雅地處理 SQL Server 連線危機"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-4.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="資料庫連線池爆掉救火秘笈！如何優雅地處理 SQL Server 連線危機"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="資料庫連線池爆掉救火秘笈！如何優雅地處理 SQL Server 連線危機">資料庫連線池爆掉救火秘笈！如何優雅地處理 SQL Server 連線危機</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-10-27T06:30:00.000Z" title="發表於 2024-10-27 14:30:00">2024-10-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%BE%8C%E7%AB%AF%E9%96%8B%E7%99%BC/">後端開發</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%BE%8C%E7%AB%AF%E9%96%8B%E7%99%BC/%E8%B3%87%E6%96%99%E5%BA%AB%E5%84%AA%E5%8C%96/">資料庫優化</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">前言 身為後端工程師，你是否遇過這樣的情況：  系統突然變得超級慢 網頁一直轉圈圈 收到「已超過連線逾時的設定」錯誤訊息  如果有，恭喜你！你可能遇到了資料庫連線池爆掉的問題。今天就來分享一個真實案例，看看如何從診斷到解決這個棘手的問題。 問題診斷 當你遇到以下錯誤訊息時，很可能是連線池出問題了： 1System.InvalidOperationException: &#x27;已超過連線逾時的設定。在取得集區連線之前超過逾時等待的時間，可能的原因為所有的共用連線已在使用中，並已達共用集區大小的最大值。&#x27; 快速診斷方法 首先，我們可以使用以下 SQL 指令來查看目前的連線狀況： 12345678910SELECT     DB_NAME(dbid) as DatabaseName,    COUNT(dbid) as NumberOfConnections,    loginame as LoginName,    status,    hostname as HostName,    program_name as ProgramNameFROM...</div></div></div><div class="recent-post-item ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-8919908724705274" data-ad-slot="1538867630"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/undefined/" title="Redis詳細介紹、使用場景及與SQL Server的結合"><img class="post-bg" src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis詳細介紹、使用場景及與SQL Server的結合"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/undefined/" title="Redis詳細介紹、使用場景及與SQL Server的結合">Redis詳細介紹、使用場景及與SQL Server的結合</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2024-09-18T08:34:11.000Z" title="發表於 2024-09-18 16:34:11">2024-09-18</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/">程式教學</a></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-comments"></i><a href="/posts/undefined/#post-comment"><span class="artalk-count" data-page-key="/posts/undefined/"><i class="fa-solid fa-spinner fa-spin"></i></span></a><span class="article-meta-label"> 則評論</span></span></div><div class="content">Redis詳細介紹、使用場景及與SQL Server的結合 什麼是Redis? Redis(Remote Dictionary Server)是一個開源的、高性能的、基於記憶體的鍵值對數據庫。它由Salvatore Sanfilippo開發,並於2009年首次發布。Redis不僅僅是一個簡單的鍵值存儲,它還支持多種數據結構,如字符串、哈希、列表、集合、有序集合等。 Redis的主要特點  高性能: Redis將所有數據存儲在記憶體中,因此可以實現極快的讀寫速度。 持久化: 儘管是記憶體數據庫,Redis也提供了數據持久化的選項。 多種數據結構: 支持字符串、哈希、列表、集合、有序集合等數據類型。 原子性操作: Redis的所有操作都是原子性的,包括那些處理複雜數據結構的操作。 多功能性: 除了作為數據庫使用,Redis還可用作緩存、消息隊列等。 支持事務: Redis支持事務,可以一次執行多個命令。 發布/訂閱功能: 實現了發布/訂閱模式,可用於消息傳遞。  Redis的使用場景 Redis因其高性能和多功能性,在多種場景下都有廣泛應用。以下是一些常見的使用場景: 1....</div></div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/tags/SQL-Server/page/2/">2</a><a class="extend next" rel="next" href="/tags/SQL-Server/page/2/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kyosora</div><div class="author-info-description">個人技術筆記和學習心得分享</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">99</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">118</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">32</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><i class="fab fa-github"></i><span>主題 GitHub</span></a><div class="card-info-social-icons"><a class="social-icon" href="mailto:my@crazywong.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">如果你在使用中遇到問題，請到 <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly/issues" style="color:#49b1f5">Github Issues</a> 進行反饋，你也可以加入反饋群（掃碼或者點擊圖片跳轉） <div class="aside-qrcode" > <a href="https://h5.qun.qq.com/s/vTHKfqL0nC" target="_blank"> <img src= "/img/loading.gif" data-lazy-src="/img/qq.jpg" title="QQ 二維碼"></a> <a href="https://t.me/bu2fly" target="_blank"> <img src= "/img/loading.gif" data-lazy-src="/img/tg.jpg" title="Telegram 二維碼"></a> </div></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/undefined/" title="使用Google Search Console驗證與修復遭受DNS污染的IIS網站"><img src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用Google Search Console驗證與修復遭受DNS污染的IIS網站"/></a><div class="content"><a class="title" href="/posts/undefined/" title="使用Google Search Console驗證與修復遭受DNS污染的IIS網站">使用Google Search Console驗證與修復遭受DNS污染的IIS網站</a><time datetime="2025-02-03T10:30:10.000Z" title="發表於 2025-02-03 18:30:10">2025-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/undefined/" title="DeepSeek-R1 深度剖析：性價比超越Claude與GPT-4的AI新選擇"><img src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DeepSeek-R1 深度剖析：性價比超越Claude與GPT-4的AI新選擇"/></a><div class="content"><a class="title" href="/posts/undefined/" title="DeepSeek-R1 深度剖析：性價比超越Claude與GPT-4的AI新選擇">DeepSeek-R1 深度剖析：性價比超越Claude與GPT-4的AI新選擇</a><time datetime="2025-01-24T10:30:06.000Z" title="發表於 2025-01-24 18:30:06">2025-01-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/undefined/" title="主管新任務來襲！資深工程師分享：7個訊號辨識成長機會或過勞陷阱"><img src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="主管新任務來襲！資深工程師分享：7個訊號辨識成長機會或過勞陷阱"/></a><div class="content"><a class="title" href="/posts/undefined/" title="主管新任務來襲！資深工程師分享：7個訊號辨識成長機會或過勞陷阱">主管新任務來襲！資深工程師分享：7個訊號辨識成長機會或過勞陷阱</a><time datetime="2025-01-23T10:34:50.000Z" title="發表於 2025-01-23 18:34:50">2025-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/undefined/" title="Quartz.NET 入門指南 - 打造可靠的.NET排程系統"><img src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Quartz.NET 入門指南 - 打造可靠的.NET排程系統"/></a><div class="content"><a class="title" href="/posts/undefined/" title="Quartz.NET 入門指南 - 打造可靠的.NET排程系統">Quartz.NET 入門指南 - 打造可靠的.NET排程系統</a><time datetime="2025-01-16T10:06:09.000Z" title="發表於 2025-01-16 18:06:09">2025-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/undefined/" title="Windows遠端桌面連線重置帳密教學"><img src= "/img/loading.gif" data-lazy-src="https://oss.012700.xyz/butterfly/2024/11/butterfly-docs-changelog-cover-9.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Windows遠端桌面連線重置帳密教學"/></a><div class="content"><a class="title" href="/posts/undefined/" title="Windows遠端桌面連線重置帳密教學">Windows遠端桌面連線重置帳密教學</a><time datetime="2025-01-03T10:30:00.000Z" title="發表於 2025-01-03 18:30:00">2025-01-03</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8919908724705274" data-ad-slot="8108145410" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新評論</span></div><div class="aside-list"><span>載入中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分類</span>
            
          </div>
          <ul class="card-category-list expandBtn" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/AI%E5%B7%A5%E5%85%B7/"><span class="card-category-list-name">AI工具</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/AI%E6%87%89%E7%94%A8/"><span class="card-category-list-name">AI應用</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Hexo/"><span class="card-category-list-name">Hexo</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python%E6%95%99%E5%AD%B8/"><span class="card-category-list-name">Python教學</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Windows-%E7%B3%BB%E7%B5%B1%E7%AE%A1%E7%90%86/"><span class="card-category-list-name">Windows 系統管理</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Windows%E6%95%99%E5%AD%B8/"><span class="card-category-list-name">Windows教學</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E6%85%A7/"><span class="card-category-list-name">人工智慧</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%AF%A6%E7%94%A8%E6%8A%80%E5%B7%A7/"><span class="card-category-list-name">實用技巧</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%AF%A6%E7%94%A8%E6%95%99%E5%AD%B8/"><span class="card-category-list-name">實用教學</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%B4%B9/"><span class="card-category-list-name">工具介紹</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%B7%A5%E5%85%B7%E6%8E%A8%E8%96%A6/"><span class="card-category-list-name">工具推薦</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/%E5%BE%8C%E7%AB%AF%E9%96%8B%E7%99%BC/"><span class="card-category-list-name">後端開發</span><span class="card-category-list-count">2</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%BE%8C%E7%AB%AF%E9%96%8B%E7%99%BC/%E8%B3%87%E6%96%99%E5%BA%AB%E5%84%AA%E5%8C%96/"><span class="card-category-list-name">資料庫優化</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9C%8D%E5%8B%99%E4%BB%8B%E7%B4%B9/"><span class="card-category-list-name">服務介紹</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%BC%94%E7%AE%97%E6%B3%95/"><span class="card-category-list-name">演算法</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%94%9F%E6%B4%BB%E6%9C%AD%E8%A8%98/"><span class="card-category-list-name">生活札記</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/"><span class="card-category-list-name">程式教學</span><span class="card-category-list-count">48</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/"><span class="card-category-list-name">程式設計</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%A8%8B%E5%BC%8F%E9%96%8B%E7%99%BC/"><span class="card-category-list-name">程式開發</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%B6%B2%E8%B7%AF/"><span class="card-category-list-name">網路</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/%E7%B6%B2%E8%B7%AF%E5%AE%89%E5%85%A8/"><span class="card-category-list-name">網路安全</span><span class="card-category-list-count">1</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%B6%B2%E8%B7%AF%E5%AE%89%E5%85%A8/%E7%B3%BB%E7%B5%B1%E7%B6%AD%E8%AD%B7/"><span class="card-category-list-name">系統維護</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%B6%B2%E9%A0%81%E9%96%8B%E7%99%BC/"><span class="card-category-list-name">網頁開發</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%81%B7%E5%A0%B4%E7%99%BC%E5%B1%95/"><span class="card-category-list-name">職場發展</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB/"><span class="card-category-list-name">資料庫</span><span class="card-category-list-count">5</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/"><span class="card-category-list-name">資訊安全</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%B3%87%E6%96%99%E5%BA%AB%E7%AE%A1%E7%90%86/"><span class="card-category-list-name">資料庫管理</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/"><span class="card-category-list-name">資訊安全</span><span class="card-category-list-count">7</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E4%BC%BA%E6%9C%8D%E5%99%A8%E7%AE%A1%E7%90%86/"><span class="card-category-list-name">伺服器管理</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%B3%87%E8%A8%8A%E5%AE%89%E5%85%A8/%E7%B3%BB%E7%B5%B1%E7%AE%A1%E7%90%86/"><span class="card-category-list-name">系統管理</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%BB%9F%E9%AB%94%E4%BB%8B%E7%B4%B9/"><span class="card-category-list-name">軟體介紹</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%96%8B%E7%99%BC%E7%9B%B8%E9%97%9C/"><span class="card-category-list-name">開發相關</span><span class="card-category-list-count">6</span></a></li>
          </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>標籤</span></div><div class="card-tag-cloud"><a href="/tags/CSS/" style="font-size: 1.35em; color: rgb(50, 77, 53);">CSS</a><a href="/tags/API%E9%99%90%E6%B5%81/" style="font-size: 1.15em; color: rgb(100, 50, 160);">API限流</a><a href="/tags/Net/" style="font-size: 1.35em; color: rgb(53, 98, 53);">Net</a><a href="/tags/C/" style="font-size: 1.3em; color: rgb(180, 50, 55);">C#</a><a href="/tags/Chrome%E9%96%8B%E7%99%BC/" style="font-size: 1.15em; color: rgb(50, 58, 50);">Chrome開發</a><a href="/tags/Content-Security-Policy/" style="font-size: 1.15em; color: rgb(105, 50, 50);">Content Security Policy</a><a href="/tags/Docker/" style="font-size: 1.25em; color: rgb(50, 120, 50);">Docker</a><a href="/tags/CORS/" style="font-size: 1.15em; color: rgb(123, 75, 79);">CORS</a><a href="/tags/DNS/" style="font-size: 1.15em; color: rgb(168, 185, 147);">DNS</a><a href="/tags/EmEditor/" style="font-size: 1.15em; color: rgb(66, 152, 64);">EmEditor</a><a href="/tags/Git/" style="font-size: 1.25em; color: rgb(50, 50, 50);">Git</a><a href="/tags/HTMX/" style="font-size: 1.15em; color: rgb(50, 76, 90);">HTMX</a><a href="/tags/Hexo/" style="font-size: 1.2em; color: rgb(185, 50, 150);">Hexo</a><a href="/tags/Go/" style="font-size: 1.15em; color: rgb(187, 88, 177);">Go</a><a href="/tags/Cookie/" style="font-size: 1.15em; color: rgb(198, 118, 50);">Cookie</a><a href="/tags/IIS/" style="font-size: 1.25em; color: rgb(147, 50, 53);">IIS</a><a href="/tags/SSL-TLS/" style="font-size: 1.15em; color: rgb(113, 84, 50);">SSL/TLS</a><a href="/tags/%E5%BC%B1%E9%BB%9E%E6%8E%83%E6%8F%8F/" style="font-size: 1.25em; color: rgb(86, 69, 82);">弱點掃描</a><a href="/tags/%E8%B3%87%E5%AE%89%E5%B7%A5%E5%85%B7/" style="font-size: 1.15em; color: rgb(137, 105, 81);">資安工具</a><a href="/tags/JavaScript/" style="font-size: 1.4em; color: rgb(194, 50, 50);">JavaScript</a><a href="/tags/LibreOffice/" style="font-size: 1.15em; color: rgb(50, 158, 171);">LibreOffice</a><a href="/tags/%E7%B6%B2%E7%AB%99%E9%83%A8%E7%BD%B2/" style="font-size: 1.2em; color: rgb(89, 90, 50);">網站部署</a><a href="/tags/%E8%B7%AF%E5%BE%91%E8%A8%AD%E5%AE%9A/" style="font-size: 1.2em; color: rgb(50, 50, 105);">路徑設定</a><a href="/tags/HTML/" style="font-size: 1.2em; color: rgb(50, 153, 136);">HTML</a><a href="/tags/ASP-NET-MVC/" style="font-size: 1.2em; color: rgb(72, 113, 104);">ASP.NET MVC</a><a href="/tags/Pinia/" style="font-size: 1.25em; color: rgb(50, 69, 76);">Pinia</a><a href="/tags/Vuex/" style="font-size: 1.15em; color: rgb(106, 50, 197);">Vuex</a><a href="/tags/Redis/" style="font-size: 1.15em; color: rgb(191, 177, 104);">Redis</a><a href="/tags/SQL-Server/" style="font-size: 1.45em; color: rgb(62, 191, 79);">SQL Server</a><a href="/tags/Python/" style="font-size: 1.3em; color: rgb(50, 50, 159);">Python</a><a href="/tags/PyInstaller/" style="font-size: 1.15em; color: rgb(126, 50, 191);">PyInstaller</a><a href="/tags/PySide6/" style="font-size: 1.15em; color: rgb(50, 63, 81);">PySide6</a><a href="/tags/%E6%89%93%E5%8C%85%E6%95%99%E5%AD%B8/" style="font-size: 1.15em; color: rgb(146, 189, 87);">打包教學</a><a href="/tags/exe/" style="font-size: 1.15em; color: rgb(76, 151, 168);">exe</a><a href="/tags/SQL/" style="font-size: 1.4em; color: rgb(50, 193, 66);">SQL</a><a href="/tags/SQLCMD/" style="font-size: 1.25em; color: rgb(135, 50, 127);">SQLCMD</a><a href="/tags/BCP/" style="font-size: 1.15em; color: rgb(62, 86, 102);">BCP</a><a href="/tags/SSIS/" style="font-size: 1.15em; color: rgb(82, 50, 168);">SSIS</a><a href="/tags/CSV%E5%8C%AF%E5%87%BA/" style="font-size: 1.15em; color: rgb(71, 50, 84);">CSV匯出</a><a href="/tags/%E6%95%88%E8%83%BD%E5%84%AA%E5%8C%96/" style="font-size: 1.35em; color: rgb(171, 137, 108);">效能優化</a></div></div><div class="card-widget card-archives">
    <div class="item-headline">
      <i class="fas fa-archive"></i>
      <span>歸檔</span>
      <a class="card-more-btn" href="/archives/"
            title="檢視更多">
            <i class="fas fa-angle-right"></i>
          </a>
    </div>
  
    <ul class="card-archive-list">
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/02/">
            <span class="card-archive-list-date">
              2025年02月
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/01/">
            <span class="card-archive-list-date">
              2025年01月
            </span>
            <span class="card-archive-list-count">6</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/12/">
            <span class="card-archive-list-date">
              2024年12月
            </span>
            <span class="card-archive-list-count">14</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/11/">
            <span class="card-archive-list-date">
              2024年11月
            </span>
            <span class="card-archive-list-count">10</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/10/">
            <span class="card-archive-list-date">
              2024年10月
            </span>
            <span class="card-archive-list-count">6</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/09/">
            <span class="card-archive-list-date">
              2024年09月
            </span>
            <span class="card-archive-list-count">10</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/08/">
            <span class="card-archive-list-date">
              2024年08月
            </span>
            <span class="card-archive-list-count">7</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2024/07/">
            <span class="card-archive-list-date">
              2024年07月
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
    </ul>
  </div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>網站資訊</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章數量 :</div><div class="item-count">99</div></div><div class="webinfo-item"><div class="item-name">運行時間 :</div><div class="item-count" id="runtimeshow" data-publishDate="2019-11-12T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">總字數 :</div><div class="item-count">110.6k</div></div><div class="webinfo-item"><div class="item-name">訪客數 :</div><div class="item-count" id="umami-site-uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">總瀏覽量 :</div><div class="item-count" id="umami-site-pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最後更新時間 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-03-10T08:57:49.330Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://oss.012700.xyz/butterfly/2024/10/tag.png);"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By kyosora</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主題 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 0.0.0</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="日夜模式切換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button id="translateLink" type="button" title="繁簡轉換">簡</button><button id="go-up" type="button" title="回到頂端"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://jsd.012700.xyz/npm/hexo-theme-butterfly/source/js/utils.min.js"></script><script src="https://jsd.012700.xyz/npm/hexo-theme-butterfly/source/js/main.min.js"></script><script src="https://jsd.012700.xyz/npm/hexo-theme-butterfly/source/js/tw_cn.min.js"></script><script src="https://jsd.012700.xyz/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://jsd.012700.xyz/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://jsd.012700.xyz/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const getArtalkCount = async() => {
    try {
      const eleGroup = document.querySelectorAll('#recent-posts .artalk-count')
      const keyArray = Array.from(eleGroup).map(i => i.getAttribute('data-page-key'))

      const headerList = {
        method: 'GET',
      }

      const searchParams = new URLSearchParams({
        'site_name': 'Butterfly-Docs',
        'page_keys': keyArray
      })

      const res = await fetch(`https://artalk.crazywong.com/api/v2/stats/page_comment?${searchParams}`, headerList)
      const result = await res.json()

      keyArray.forEach((key, index) => {
        eleGroup[index].textContent = result.data[key] || 0
      })
    } catch (err) {
      console.error(err)
    }
  }

  window.pjax ? getArtalkCount() : window.addEventListener('load', getArtalkCount)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://jsd.012700.xyz/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const applyThemeDefaultsConfig = theme => {
    if (theme === 'dark-mode') {
      Chart.defaults.color = "rgba(255, 255, 255, 0.8)"
      Chart.defaults.borderColor = "rgba(255, 255, 255, 0.2)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    } else {
      Chart.defaults.color = "rgba(0, 0, 0, 0.8)"
      Chart.defaults.borderColor = "rgba(0, 0, 0, 0.1)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    }
  }

  // Recursively traverse the config object and automatically apply theme-specific color schemes
  const applyThemeConfig = (obj, theme) => {
    if (typeof obj !== 'object' || obj === null) return

    Object.keys(obj).forEach(key => {
      const value = obj[key]
      // If the property is an object and has theme-specific options, apply them
      if (typeof value === 'object' && value !== null) {
        if (value[theme]) {
          obj[key] = value[theme] // Apply the value for the current theme
        } else {
          // Recursively process child objects
          applyThemeConfig(value, theme)
        }
      }
    })
  }

  const runChartJS = ele => {
    window.loadChartJS = true

    Array.from(ele).forEach((item, index) => {
      const chartSrc = item.firstElementChild
      const chartID = item.getAttribute('data-chartjs-id') || ('chartjs-' + index) // Use custom ID or default ID
      const width = item.getAttribute('data-width')
      const existingCanvas = document.getElementById(chartID)

      // If a canvas already exists, remove it to avoid rendering duplicates
      if (existingCanvas) {
          existingCanvas.parentNode.remove()
      }

      const chartDefinition = chartSrc.textContent
      const canvas = document.createElement('canvas')
      canvas.id = chartID

      const div = document.createElement('div')
      div.className = 'chartjs-wrap'

      if (width) {
        div.style.width = width
      }

      div.appendChild(canvas)
      chartSrc.insertAdjacentElement('afterend', div)

      const ctx = document.getElementById(chartID).getContext('2d')

      const config = JSON.parse(chartDefinition)

      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark-mode' : 'light-mode'

      // Set default styles (initial setup)
      applyThemeDefaultsConfig(theme)

      // Automatically traverse the config and apply dual-mode color schemes
      applyThemeConfig(config, theme)

      new Chart(ctx, config)
    })
  }

  const loadChartJS = () => {
    const chartJSEle = document.querySelectorAll('#article-container .chartjs-container')
    if (chartJSEle.length === 0) return

    window.loadChartJS ? runChartJS(chartJSEle) : btf.getScript('https://jsd.012700.xyz/npm/chart.js/dist/chart.umd.min.js').then(() => runChartJS(chartJSEle))
  }

  // Listen for theme change events
  btf.addGlobalFn('themeChange', loadChartJS, 'chartjs')
  btf.addGlobalFn('encrypt', loadChartJS, 'chartjs')

  window.pjax ? loadChartJS() : document.addEventListener('DOMContentLoaded', loadChartJS)
})()</script></div><script>window.newestComments = {
  changeContent: content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[圖片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[連結]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[程式碼]') // replace code
    content = content.replace(/<code>.*?<\/code>/gi, '[程式碼]') // replace code
    content = content.replace(/<[^>]+>/g, "") // remove html tag

    if (content.length > 150) {
      content = content.substring(0, 150) + '...'
    }
    return content
  },

  generateHtml: (array, ele) => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class="aside-list-item">'

        if (true && array[i].avatar) {
          const imgAttr = 'data-lazy-src'
          const lazyloadNative = ''
          result += `<a href="${array[i].url}" class="thumbnail"><img ${imgAttr}="${array[i].avatar}" alt="${array[i].nick}" ${lazyloadNative}></a>`
        }

        result += `<div class="content">
        <a class="comment" href="${array[i].url}" title="${array[i].content}">${array[i].content}</a>
        <div class="name"><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '尚無評論'
    }

    ele.innerHTML = result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh(ele)
  },

  newestCommentInit: (name, getComment) => {
    const $dom = document.querySelector('#card-newest-comments .aside-list')
    if ($dom) {
      const data = btf.saveToLocal.get(name)
      if (data) {
        newestComments.generateHtml(JSON.parse(data), $dom)
      } else {
        getComment($dom)
      }
    }
  },

  run: (name, getComment) => {
    newestComments.newestCommentInit(name, getComment)
    btf.addGlobalFn('pjaxComplete', () => newestComments.newestCommentInit(name, getComment), name)
  }
}</script><script>window.addEventListener('load', () => {
  const keyName = 'artalk-newest-comments'
  const { changeContent, generateHtml, run } = window.newestComments

  const getAvatarValue = async () => {
    const predefinedAvatarCdn = ''
    const predefinedAvatarDefault = ''

    const avatarDefaultFormat = e => e.startsWith('d=') ? e : `d=${e}`

    if (predefinedAvatarCdn && predefinedAvatarDefault) {
      return { avatarCdn: predefinedAvatarCdn, avatarDefault: avatarDefaultFormat(predefinedAvatarDefault) }
    }

    try {
      const res = await fetch('https://artalk.crazywong.com/api/v2/conf')
      const result = await res.json()
      const { mirror, params, default: defaults } = result.frontend_conf.gravatar
      const avatarCdn = predefinedAvatarCdn || mirror
      let avatarDefault = avatarDefaultFormat(predefinedAvatarDefault || params || defaults)
      return { avatarCdn, avatarDefault}
    } catch (e) {
      console.error(e)
      return { avatarCdn: predefinedAvatarCdn, avatarDefault: avatarDefaultFormat(predefinedAvatarDefault) }
    }
  }

  const searchParams = new URLSearchParams({
    'site_name': 'Butterfly-Docs',
    'limit': '12', // Fetch more comments to filter pending comments
  })

  const getComment = async (ele) => {
    try {
      const res = await fetch(`https://artalk.crazywong.com/api/v2/stats/latest_comments?${searchParams}`)
      const result = await res.json()
      const { avatarCdn, avatarDefault } = await getAvatarValue()
      const artalk = result.data
        .filter(e => !e.is_pending) // Filter pending comments
        .slice(0, 6) // Limit the number of comments
        .map(e => {
          const avatar = avatarCdn && e.email_encrypted ? `${avatarCdn}${e.email_encrypted}?${avatarDefault}` : ''
          return {
            'avatar': avatar,
            'content': changeContent(e.content_marked),
            'nick': e.nick,
            'url': e.page_url,
            'date': e.date,
          }
        })
      btf.saveToLocal.set(keyName, JSON.stringify(artalk), 5/(60*24))
      generateHtml(artalk, ele)
    } catch (e) {
      console.log(e)
      ele.textContent= "無法獲取評論，請確認相關配置是否正確"
    }
  }

  run(keyName, getComment)
})</script><script data-pjax src="/self/btf.js"></script><script defer="defer" id="ribbon" src="https://jsd.012700.xyz/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://jsd.012700.xyz/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      true 
        ? (usePjax ? pjax.loadUrl('/404') : window.location.href = '/404')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script>(() => {
  const option = null
  const config = {"site_uv":true,"site_pv":true,"page_pv":true,"token":"qTvz1SkmPDt785fgh6BpiA5qiFFIVUwxj8Ft+rPW+cdN59v1hXjwRgSmy0+ji9m+oLlcxvo2NfDSMa6epVl3NTlsN3ejCIwWeP8Y51aEJ0Sbem4UexGmJLspB7AkOBId2SdtT6QWEBlGmFIIQgchQ2zAKYxTmc/kpBED5aLSr+3uvmQ9/G7FJQeVFpveDkK0xM1hu36xq4a6/FSeROxtoEp5zabzTWiYTlLsQzIl/NlELnCq3nxK+oo/vl3UQo/oM/rae/gJX/MaVKsgIUCd2ABJogNkx2KTenBIBpbPki5FzOgPh6/z4GPa4HvhNO51DDVG1SEQZooqEYmt/gnybLBWFbN+7liZWw=="}

  const runTrack = () => {
    umami.track(props => ({ ...props, url: window.location.pathname, title: GLOBAL_CONFIG_SITE.title }))
  }

  const loadUmamiJS = () => {
    btf.getScript('https://umami.012700.xyz/script.js', {
      'data-website-id': '2a796d6c-6499-42d8-8eb4-d9a2930b0ff3',
      'data-auto-track': 'false',
      ...option
    }).then(runTrack)
  }

  const getData = async (isPost) => {
    const now = Date.now()
    const keyUrl = isPost ? `&url=${window.location.pathname}` : ''
    const headerList = { 'Accept': 'application/json' }
    if (true) headerList['Authorization'] = `Bearer ${config.token}`
    else headerList['x-umami-api-key'] = config.token
    const res = await fetch(`https://umami.012700.xyz/api/websites/2a796d6c-6499-42d8-8eb4-d9a2930b0ff3/stats?startAt=0000000000&endAt=${now}${keyUrl}`, {
      method: "GET",
      headers: headerList
    })
    return await res.json()
  }

  const insertData = async () => {
    try {
      if (GLOBAL_CONFIG_SITE.pageType === 'post' && config.page_pv) {
        const pagePV = document.getElementById('umamiPV')
        if (pagePV) {
          const data = await getData(true)
          pagePV.textContent = data.pageviews.value
        }
      } else {
        const data = (config.site_uv || config.site_pv) && await getData()
        if (config.site_uv) {
          const siteUV = document.getElementById('umami-site-uv')
          if (siteUV) siteUV.textContent = data.visitors.value
        }
        if (config.site_pv) {
          const sitePV = document.getElementById('umami-site-pv')
          if (sitePV) sitePV.textContent = data.pageviews.value
        }
      }
    } catch (e) {
      console.error('Failed to load Umami Analytics:', e)
    }
  }

  btf.addGlobalFn('pjaxComplete', runTrack, 'umami_analytics_run_track')
  btf.addGlobalFn('pjaxComplete', insertData, 'umami_analytics_insert')

  loadUmamiJS()
  insertData()
})()</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜尋</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  資料載入中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜尋文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="https://jsd.012700.xyz/npm/hexo-theme-butterfly/source/js/search/local-search.min.js"></script></div></div></body></html>