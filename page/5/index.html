<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"kyosora.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="個人技術筆記和學習心得分享">
<meta property="og:type" content="website">
<meta property="og:title" content="kyosora 虛空筆記">
<meta property="og:url" content="https://kyosora.github.io/page/5/index.html">
<meta property="og:site_name" content="kyosora 虛空筆記">
<meta property="og:description" content="個人技術筆記和學習心得分享">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="kyosora">
<meta property="article:tag" content="網路安全, 系統管理, 程式設計, 技術筆記">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://kyosora.github.io/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-TW'
  };
</script>

  <title>kyosora 虛空筆記</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">kyosora 虛空筆記</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">技術探索與學習分享</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/09/19/cm82sqlga003ma4970j9y9ig4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/19/cm82sqlga003ma4970j9y9ig4/" class="post-title-link" itemprop="url">SQL中的CASE語法：強大而靈活的條件表達式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-09-19 10:09:44" itemprop="dateCreated datePublished" datetime="2024-09-19T10:09:44+08:00">2024-09-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:37:46" itemprop="dateModified" datetime="2024-11-27T14:37:46+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/" itemprop="url" rel="index"><span itemprop="name">程式教學</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SQL中的CASE語法-強大而靈活的條件表達式"><a href="#SQL中的CASE語法-強大而靈活的條件表達式" class="headerlink" title="SQL中的CASE語法:強大而靈活的條件表達式"></a>SQL中的CASE語法:強大而靈活的條件表達式</h1><p>在SQL中,CASE語法是一個非常實用且強大的工具。它允許我們在查詢中進行條件判斷,根據不同的情況返回不同的結果。本文將深入探討CASE語法的用法、優點以及實際應用場景。</p>
<h2 id="CASE語法的基本結構"><a href="#CASE語法的基本結構" class="headerlink" title="CASE語法的基本結構"></a>CASE語法的基本結構</h2><p>CASE語法有兩種基本形式:簡單CASE和搜索CASE。</p>
<h3 id="簡單CASE語法"><a href="#簡單CASE語法" class="headerlink" title="簡單CASE語法"></a>簡單CASE語法</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CASE</span> 表達式
    <span class="token keyword">WHEN</span> 值<span class="token number">1</span> <span class="token keyword">THEN</span> 結果<span class="token number">1</span>
    <span class="token keyword">WHEN</span> 值<span class="token number">2</span> <span class="token keyword">THEN</span> 結果<span class="token number">2</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">[</span><span class="token keyword">ELSE</span> 其他結果<span class="token punctuation">]</span>
<span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="搜索CASE語法"><a href="#搜索CASE語法" class="headerlink" title="搜索CASE語法"></a>搜索CASE語法</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> 條件<span class="token number">1</span> <span class="token keyword">THEN</span> 結果<span class="token number">1</span>
    <span class="token keyword">WHEN</span> 條件<span class="token number">2</span> <span class="token keyword">THEN</span> 結果<span class="token number">2</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">[</span><span class="token keyword">ELSE</span> 其他結果<span class="token punctuation">]</span>
<span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="CASE語法的優點"><a href="#CASE語法的優點" class="headerlink" title="CASE語法的優點"></a>CASE語法的優點</h2><ol>
<li>靈活性:可以處理複雜的條件邏輯</li>
<li>可讀性:使查詢更易於理解</li>
<li>效能:通常比使用多個IF語句更有效率</li>
<li>多功能性:可以在SELECT、WHERE、ORDER BY等子句中使用</li>
</ol>
<h2 id="實際應用場景"><a href="#實際應用場景" class="headerlink" title="實際應用場景"></a>實際應用場景</h2><p>讓我們來看幾個CASE語法的實際應用例子:</p>
<h3 id="例子1-根據成績分級"><a href="#例子1-根據成績分級" class="headerlink" title="例子1:根據成績分級"></a>例子1:根據成績分級</h3><p>假設我們有一個包含學生成績的資料表,我們想要根據分數給出對應的等級:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    學生姓名<span class="token punctuation">,</span>
    分數<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> 分數 <span class="token operator">>=</span> <span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token string">'A'</span>
        <span class="token keyword">WHEN</span> 分數 <span class="token operator">>=</span> <span class="token number">80</span> <span class="token keyword">THEN</span> <span class="token string">'B'</span>
        <span class="token keyword">WHEN</span> 分數 <span class="token operator">>=</span> <span class="token number">70</span> <span class="token keyword">THEN</span> <span class="token string">'C'</span>
        <span class="token keyword">WHEN</span> 分數 <span class="token operator">>=</span> <span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token string">'D'</span>
        <span class="token keyword">ELSE</span> <span class="token string">'F'</span>
    <span class="token keyword">END</span> <span class="token keyword">AS</span> 等級
<span class="token keyword">FROM</span> 學生成績表<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="例子2-根據部門計算不同的薪資增長"><a href="#例子2-根據部門計算不同的薪資增長" class="headerlink" title="例子2:根據部門計算不同的薪資增長"></a>例子2:根據部門計算不同的薪資增長</h3><p>假設不同部門有不同的薪資增長率:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    員工姓名<span class="token punctuation">,</span>
    部門<span class="token punctuation">,</span>
    目前薪資<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span> 部門
        <span class="token keyword">WHEN</span> <span class="token string">'銷售'</span> <span class="token keyword">THEN</span> 目前薪資 <span class="token operator">*</span> <span class="token number">1.1</span>
        <span class="token keyword">WHEN</span> <span class="token string">'技術'</span> <span class="token keyword">THEN</span> 目前薪資 <span class="token operator">*</span> <span class="token number">1.05</span>
        <span class="token keyword">WHEN</span> <span class="token string">'行政'</span> <span class="token keyword">THEN</span> 目前薪資 <span class="token operator">*</span> <span class="token number">1.03</span>
        <span class="token keyword">ELSE</span> 目前薪資
    <span class="token keyword">END</span> <span class="token keyword">AS</span> 調整後薪資
<span class="token keyword">FROM</span> 員工資料表<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="例子3-在GROUP-BY中使用CASE"><a href="#例子3-在GROUP-BY中使用CASE" class="headerlink" title="例子3:在GROUP BY中使用CASE"></a>例子3:在GROUP BY中使用CASE</h3><p>CASE語法也可以用在GROUP BY子句中,實現更複雜的分組邏輯:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
    <span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> 年齡 <span class="token operator">&lt;</span> <span class="token number">18</span> <span class="token keyword">THEN</span> <span class="token string">'未成年'</span>
        <span class="token keyword">WHEN</span> 年齡 <span class="token operator">BETWEEN</span> <span class="token number">18</span> <span class="token operator">AND</span> <span class="token number">65</span> <span class="token keyword">THEN</span> <span class="token string">'成年'</span>
        <span class="token keyword">ELSE</span> <span class="token string">'銀髮族'</span>
    <span class="token keyword">END</span> <span class="token keyword">AS</span> 年齡組<span class="token punctuation">,</span>
    <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 人數
<span class="token keyword">FROM</span> 客戶資料表
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 
    <span class="token keyword">CASE</span> 
        <span class="token keyword">WHEN</span> 年齡 <span class="token operator">&lt;</span> <span class="token number">18</span> <span class="token keyword">THEN</span> <span class="token string">'未成年'</span>
        <span class="token keyword">WHEN</span> 年齡 <span class="token operator">BETWEEN</span> <span class="token number">18</span> <span class="token operator">AND</span> <span class="token number">65</span> <span class="token keyword">THEN</span> <span class="token string">'成年'</span>
        <span class="token keyword">ELSE</span> <span class="token string">'銀髮族'</span>
    <span class="token keyword">END</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="CASE語法在UPDATE語句中的應用"><a href="#CASE語法在UPDATE語句中的應用" class="headerlink" title="CASE語法在UPDATE語句中的應用"></a>CASE語法在UPDATE語句中的應用</h2><p>除了在SELECT語句中使用CASE,我們也經常在UPDATE語句中運用CASE來實現條件更新。這允許我們根據不同的條件對資料進行更複雜的更新操作。</p>
<h3 id="UPDATE語句中使用CASE的基本語法"><a href="#UPDATE語句中使用CASE的基本語法" class="headerlink" title="UPDATE語句中使用CASE的基本語法"></a>UPDATE語句中使用CASE的基本語法</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">UPDATE</span> 資料表
<span class="token keyword">SET</span> 欄位 <span class="token operator">=</span> <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> 條件<span class="token number">1</span> <span class="token keyword">THEN</span> 值<span class="token number">1</span>
    <span class="token keyword">WHEN</span> 條件<span class="token number">2</span> <span class="token keyword">THEN</span> 值<span class="token number">2</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">ELSE</span> 預設值
<span class="token keyword">END</span>
<span class="token keyword">WHERE</span> 條件<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="實際應用例子"><a href="#實際應用例子" class="headerlink" title="實際應用例子"></a>實際應用例子</h3><p>讓我們來看幾個在UPDATE語句中使用CASE的實際例子:</p>
<h4 id="例子1-根據員工表現更新薪資"><a href="#例子1-根據員工表現更新薪資" class="headerlink" title="例子1:根據員工表現更新薪資"></a>例子1:根據員工表現更新薪資</h4><p>假設我們要根據員工的表現評級來更新他們的薪資:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">UPDATE</span> 員工資料表
<span class="token keyword">SET</span> 薪資 <span class="token operator">=</span> <span class="token keyword">CASE</span> 表現評級
    <span class="token keyword">WHEN</span> <span class="token string">'A'</span> <span class="token keyword">THEN</span> 薪資 <span class="token operator">*</span> <span class="token number">1.1</span>
    <span class="token keyword">WHEN</span> <span class="token string">'B'</span> <span class="token keyword">THEN</span> 薪資 <span class="token operator">*</span> <span class="token number">1.05</span>
    <span class="token keyword">WHEN</span> <span class="token string">'C'</span> <span class="token keyword">THEN</span> 薪資 <span class="token operator">*</span> <span class="token number">1.02</span>
    <span class="token keyword">ELSE</span> 薪資
<span class="token keyword">END</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>這個查詢會根據員工的表現評級來增加他們的薪資。A級員工加薪10%,B級5%,C級2%,其他保持不變。</p>
<h4 id="例子2-根據庫存量更新產品狀態"><a href="#例子2-根據庫存量更新產品狀態" class="headerlink" title="例子2:根據庫存量更新產品狀態"></a>例子2:根據庫存量更新產品狀態</h4><p>假設我們要根據產品的庫存量來更新其狀態:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">UPDATE</span> 產品資料表
<span class="token keyword">SET</span> 狀態 <span class="token operator">=</span> <span class="token keyword">CASE</span>
    <span class="token keyword">WHEN</span> 庫存量 <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'缺貨'</span>
    <span class="token keyword">WHEN</span> 庫存量 <span class="token operator">BETWEEN</span> <span class="token number">1</span> <span class="token operator">AND</span> <span class="token number">10</span> <span class="token keyword">THEN</span> <span class="token string">'低庫存'</span>
    <span class="token keyword">WHEN</span> 庫存量 <span class="token operator">BETWEEN</span> <span class="token number">11</span> <span class="token operator">AND</span> <span class="token number">50</span> <span class="token keyword">THEN</span> <span class="token string">'適中'</span>
    <span class="token keyword">ELSE</span> <span class="token string">'充足'</span>
<span class="token keyword">END</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>這個查詢會根據產品的庫存量自動更新產品狀態。</p>
<h4 id="例子3-在單一UPDATE語句中更新多個欄位"><a href="#例子3-在單一UPDATE語句中更新多個欄位" class="headerlink" title="例子3:在單一UPDATE語句中更新多個欄位"></a>例子3:在單一UPDATE語句中更新多個欄位</h4><p>CASE語法的一個強大功能是它允許我們在一個UPDATE語句中根據不同條件更新多個欄位:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">UPDATE</span> 訂單資料表
<span class="token keyword">SET</span> 
    處理狀態 <span class="token operator">=</span> <span class="token keyword">CASE</span>
        <span class="token keyword">WHEN</span> 付款狀態 <span class="token operator">=</span> <span class="token string">'已付款'</span> <span class="token operator">AND</span> 運送狀態 <span class="token operator">=</span> <span class="token string">'已發貨'</span> <span class="token keyword">THEN</span> <span class="token string">'已完成'</span>
        <span class="token keyword">WHEN</span> 付款狀態 <span class="token operator">=</span> <span class="token string">'已付款'</span> <span class="token operator">AND</span> 運送狀態 <span class="token operator">=</span> <span class="token string">'準備中'</span> <span class="token keyword">THEN</span> <span class="token string">'處理中'</span>
        <span class="token keyword">WHEN</span> 付款狀態 <span class="token operator">=</span> <span class="token string">'未付款'</span> <span class="token keyword">THEN</span> <span class="token string">'等待付款'</span>
        <span class="token keyword">ELSE</span> <span class="token string">'處理中'</span>
    <span class="token keyword">END</span><span class="token punctuation">,</span>
    優先級 <span class="token operator">=</span> <span class="token keyword">CASE</span>
        <span class="token keyword">WHEN</span> 訂單金額 <span class="token operator">></span> <span class="token number">10000</span> <span class="token keyword">THEN</span> <span class="token string">'高'</span>
        <span class="token keyword">WHEN</span> 訂單金額 <span class="token operator">BETWEEN</span> <span class="token number">5000</span> <span class="token operator">AND</span> <span class="token number">10000</span> <span class="token keyword">THEN</span> <span class="token string">'中'</span>
        <span class="token keyword">ELSE</span> <span class="token string">'低'</span>
    <span class="token keyword">END</span>
<span class="token keyword">WHERE</span> 訂單日期 <span class="token operator">=</span> <span class="token keyword">CURRENT_DATE</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>這個查詢同時更新了訂單的處理狀態和優先級,基於不同的條件。</p>
<h2 id="使用CASE進行UPDATE時的注意事項"><a href="#使用CASE進行UPDATE時的注意事項" class="headerlink" title="使用CASE進行UPDATE時的注意事項"></a>使用CASE進行UPDATE時的注意事項</h2><ol>
<li><p>效能考量:在大型資料表上使用複雜的CASE語句進行UPDATE可能會影響效能。在這種情況下,可以考慮分批處理或使用索引來優化。</p>
</li>
<li><p>資料一致性:確保CASE語句涵蓋了所有可能的情況,以避免意外的NULL值或錯誤的更新。</p>
</li>
<li><p>交易管理:在進行大規模或關鍵的更新時,建議使用交易(Transaction)來確保資料的一致性和可回溯性。</p>
</li>
<li><p>測試:在實際執行UPDATE之前,可以先使用SELECT語句和相同的CASE邏輯來預覽更新的結果,以確保更新的正確性。</p>
</li>
</ol>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>CASE語法不僅在SELECT語句中有廣泛應用,在UPDATE語句中也是一個強大的工具。它允許我們根據複雜的條件邏輯來更新資料,提高了資料操作的靈活性和效率。無論是在資料查詢還是更新中,靈活運用CASE語法都可以幫助我們更好地處理複雜的業務邏輯,提升SQL程式碼的表達能力和可維護性。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/09/18/cm82sqlfw002ia4977jo53z2k/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/18/cm82sqlfw002ia4977jo53z2k/" class="post-title-link" itemprop="url">Redis詳細介紹、使用場景及與SQL Server的結合</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-09-18 16:34:11" itemprop="dateCreated datePublished" datetime="2024-09-18T16:34:11+08:00">2024-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:35:26" itemprop="dateModified" datetime="2024-11-27T14:35:26+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/" itemprop="url" rel="index"><span itemprop="name">程式教學</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Redis詳細介紹、使用場景及與SQL-Server的結合"><a href="#Redis詳細介紹、使用場景及與SQL-Server的結合" class="headerlink" title="Redis詳細介紹、使用場景及與SQL Server的結合"></a>Redis詳細介紹、使用場景及與SQL Server的結合</h1><h2 id="什麼是Redis"><a href="#什麼是Redis" class="headerlink" title="什麼是Redis?"></a>什麼是Redis?</h2><p>Redis(Remote Dictionary Server)是一個開源的、高性能的、基於記憶體的鍵值對數據庫。它由Salvatore Sanfilippo開發,並於2009年首次發布。Redis不僅僅是一個簡單的鍵值存儲,它還支持多種數據結構,如字符串、哈希、列表、集合、有序集合等。</p>
<h2 id="Redis的主要特點"><a href="#Redis的主要特點" class="headerlink" title="Redis的主要特點"></a>Redis的主要特點</h2><ol>
<li><strong>高性能</strong>: Redis將所有數據存儲在記憶體中,因此可以實現極快的讀寫速度。</li>
<li><strong>持久化</strong>: 儘管是記憶體數據庫,Redis也提供了數據持久化的選項。</li>
<li><strong>多種數據結構</strong>: 支持字符串、哈希、列表、集合、有序集合等數據類型。</li>
<li><strong>原子性操作</strong>: Redis的所有操作都是原子性的,包括那些處理複雜數據結構的操作。</li>
<li><strong>多功能性</strong>: 除了作為數據庫使用,Redis還可用作緩存、消息隊列等。</li>
<li><strong>支持事務</strong>: Redis支持事務,可以一次執行多個命令。</li>
<li><strong>發布/訂閱功能</strong>: 實現了發布/訂閱模式,可用於消息傳遞。</li>
</ol>
<h2 id="Redis的使用場景"><a href="#Redis的使用場景" class="headerlink" title="Redis的使用場景"></a>Redis的使用場景</h2><p>Redis因其高性能和多功能性,在多種場景下都有廣泛應用。以下是一些常見的使用場景:</p>
<h3 id="1-緩存系統"><a href="#1-緩存系統" class="headerlink" title="1. 緩存系統"></a>1. 緩存系統</h3><p>Redis最常見的用途之一是作為緩存系統。它可以存儲頻繁訪問的數據,減少對後端數據庫的訪問,從而提高應用程序的響應速度。</p>
<p><strong>示例</strong>: 在一個電子商務網站中,商品信息可以緩存在Redis中。當用戶瀏覽商品時,系統首先檢查Redis,如果找到數據就直接返回,否則才去查詢數據庫並更新緩存。</p>
<h3 id="2-會話存儲"><a href="#2-會話存儲" class="headerlink" title="2. 會話存儲"></a>2. 會話存儲</h3><p>Redis的高速讀寫特性使其成為存儲短期會話數據的理想選擇。</p>
<p><strong>示例</strong>: 在Web應用中,用戶的會話信息可以存儲在Redis中。每次用戶與應用交互時,可以快速檢索和更新會話數據。</p>
<h3 id="3-實時分析"><a href="#3-實時分析" class="headerlink" title="3. 實時分析"></a>3. 實時分析</h3><p>Redis可以用於跟踪實時數據和執行實時分析。</p>
<p><strong>示例</strong>: 在一個社交媒體平台中,Redis可以用來實時跟踪熱門話題或趨勢。每當有新的帖子或互動時,相關的計數器可以在Redis中快速更新。</p>
<h3 id="4-排行榜-計數器"><a href="#4-排行榜-計數器" class="headerlink" title="4. 排行榜/計數器"></a>4. 排行榜/計數器</h3><p>Redis的有序集合(Sorted Set)非常適合實現排行榜功能。</p>
<p><strong>示例</strong>: 在一個在線遊戲中,玩家的分數可以存儲在Redis的有序集合中。Redis可以輕鬆地返回前N名玩家或某個玩家的排名。</p>
<h3 id="5-消息隊列"><a href="#5-消息隊列" class="headerlink" title="5. 消息隊列"></a>5. 消息隊列</h3><p>Redis的列表數據結構可以用作輕量級消息隊列。</p>
<p><strong>示例</strong>: 在一個任務處理系統中,待處理的任務可以推送到Redis列表中。處理程序可以從列表中獲取任務並執行。</p>
<h3 id="6-地理空間數據"><a href="#6-地理空間數據" class="headerlink" title="6. 地理空間數據"></a>6. 地理空間數據</h3><p>Redis 3.2版本引入了地理空間索引,可以用於存儲和查詢地理位置數據。</p>
<p><strong>示例</strong>: 在一個打車應用中,可以使用Redis存儲司機的實時位置,並快速查找某個位置附近的可用司機。</p>
<h2 id="Redis與SQL-Server的結合使用"><a href="#Redis與SQL-Server的結合使用" class="headerlink" title="Redis與SQL Server的結合使用"></a>Redis與SQL Server的結合使用</h2><p>在現代系統架構中,同時使用Redis和SQL Server是一種常見且有效的策略,被稱為多數據存儲架構或混合數據存儲架構。這種組合能夠充分發揮兩種數據庫的優勢,創建更高效、更靈活的數據處理系統。</p>
<h3 id="為什麼要結合使用"><a href="#為什麼要結合使用" class="headerlink" title="為什麼要結合使用?"></a>為什麼要結合使用?</h3><ol>
<li><p><strong>SQL Server</strong>: </p>
<ul>
<li>適合存儲結構化數據</li>
<li>支持複雜的查詢和事務處理</li>
<li>提供強大的數據管理功能</li>
</ul>
</li>
<li><p><strong>Redis</strong>: </p>
<ul>
<li>提供極快的讀寫速度</li>
<li>適合緩存和實時數據處理</li>
<li>支持多種數據結構,適用於特定場景</li>
</ul>
</li>
</ol>
<h3 id="典型使用場景"><a href="#典型使用場景" class="headerlink" title="典型使用場景"></a>典型使用場景</h3><ol>
<li><p><strong>緩存層</strong>:</p>
<ul>
<li>主數據存儲在SQL Server中</li>
<li>頻繁訪問的數據緩存在Redis中</li>
<li>顯著提高讀取速度,減輕SQL Server的負擔</li>
</ul>
</li>
<li><p><strong>會話管理</strong>:</p>
<ul>
<li>用戶帳戶信息存儲在SQL Server中</li>
<li>會話數據(如登錄狀態)存儲在Redis中</li>
<li>實現快速的會話檢查和管理</li>
</ul>
</li>
<li><p><strong>實時分析</strong>:</p>
<ul>
<li>歷史數據存儲在SQL Server中</li>
<li>實時統計數據存儲在Redis中</li>
<li>支持快速更新和查詢實時數據</li>
</ul>
</li>
<li><p><strong>任務隊列</strong>:</p>
<ul>
<li>任務詳細信息存儲在SQL Server中</li>
<li>待處理任務隊列使用Redis列表</li>
<li>實現高效的任務分發和處理</li>
</ul>
</li>
</ol>
<h3 id="實現方式"><a href="#實現方式" class="headerlink" title="實現方式"></a>實現方式</h3><ul>
<li>在應用層面管理數據的分配和同步</li>
<li>使用適當的緩存策略(如寫入策略、過期策略)確保數據一致性</li>
<li>根據數據特性和訪問模式決定最適合的存儲位置</li>
</ul>
<h3 id="優勢"><a href="#優勢" class="headerlink" title="優勢"></a>優勢</h3><ol>
<li>結合了SQL Server的強大數據管理能力和Redis的高性能</li>
<li>顯著提高系統整體性能和擴展性</li>
<li>能夠靈活應對不同類型的數據需求</li>
</ol>
<h3 id="注意事項"><a href="#注意事項" class="headerlink" title="注意事項"></a>注意事項</h3><ol>
<li>需要仔細處理數據同步和一致性問題</li>
<li>增加了系統複雜性,需要更多的開發和維護工作</li>
<li>需要合理平衡資源使用,避免過度依賴某一存儲系統</li>
</ol>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>Redis憑藉其高性能、靈活性和豐富的功能,在現代軟件架構中扮演著重要角色。無論是單獨使用還是與SQL Server等關係型數據庫結合,Redis都能夠為系統帶來顯著的性能提升和功能擴展。</p>
<p>在選擇使用Redis時,需要考慮其內存使用、數據一致性等因素。而在與SQL Server結合使用時,更需要仔細設計數據流和存儲策略,以充分發揮兩種數據庫的優勢。</p>
<p>通過合理使用Redis和SQL Server的組合,開發者可以創建出高效、可靈活擴展且能夠處理各種複雜數據需求的強大系統。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/09/12/cm82sqlgf003va4978y06a1jg/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/12/cm82sqlgf003va4978y06a1jg/" class="post-title-link" itemprop="url">Vue 組件緩存問題與解決方案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-09-12 18:07:08" itemprop="dateCreated datePublished" datetime="2024-09-12T18:07:08+08:00">2024-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:39:26" itemprop="dateModified" datetime="2024-11-27T14:39:26+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/" itemprop="url" rel="index"><span itemprop="name">程式教學</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Vue-組件緩存問題與解決方案"><a href="#Vue-組件緩存問題與解決方案" class="headerlink" title="Vue 組件緩存問題與解決方案"></a>Vue 組件緩存問題與解決方案</h1><p>在開發 Vue.js 應用程式時，我們經常會遇到組件緩存的問題。特別是使用 <code>httpVueLoader</code> 動態載入組件時，瀏覽器的緩存機制可能會導致更新後的組件無法即時反映在畫面上。本文將分享幾種實用的解決方案，幫助你擺脫緩存困擾。</p>
<h2 id="問題情境"><a href="#問題情境" class="headerlink" title="問題情境"></a>問題情境</h2><p>假設我們有以下幾個使用 <code>httpVueLoader</code> 載入的組件：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'x-spit'</span><span class="token punctuation">,</span> <span class="token function">httpVueLoader</span><span class="token punctuation">(</span><span class="token string">'DrainFacility/SurveyPit.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 陰井</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'x-shole'</span><span class="token punctuation">,</span> <span class="token function">httpVueLoader</span><span class="token punctuation">(</span><span class="token string">'DrainFacility/SurveyHole.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 人孔</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'x-spiple'</span><span class="token punctuation">,</span> <span class="token function">httpVueLoader</span><span class="token punctuation">(</span><span class="token string">'DrainFacility/SurveyPiple.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 連接管</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'x-spipeline'</span><span class="token punctuation">,</span> <span class="token function">httpVueLoader</span><span class="token punctuation">(</span><span class="token string">'DrainFacility/SurveyPipeline.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 管線</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>當我們修改這些 <code>.vue</code> 檔案的內容時，可能會發現修改後的內容並沒有立即反映在網頁上。這是因為瀏覽器為了提升效能，會將這些檔案暫存起來，導致我們看到的還是舊版本的內容。</p>
<h2 id="解決方案"><a href="#解決方案" class="headerlink" title="解決方案"></a>解決方案</h2><h3 id="1-加入版本號或時間戳"><a href="#1-加入版本號或時間戳" class="headerlink" title="1. 加入版本號或時間戳"></a>1. 加入版本號或時間戳</h3><p>最簡單的解決方案是在檔案路徑後面加入一個動態參數：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 使用時間戳</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'x-spit'</span><span class="token punctuation">,</span> <span class="token function">httpVueLoader</span><span class="token punctuation">(</span><span class="token string">'DrainFacility/SurveyPit.vue?v='</span> <span class="token operator">+</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 或使用版本號</span>
<span class="token keyword">const</span> <span class="token constant">VERSION</span> <span class="token operator">=</span> <span class="token string">'1.0.1'</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'x-spit'</span><span class="token punctuation">,</span> <span class="token function">httpVueLoader</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">DrainFacility/SurveyPit.vue?v=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">VERSION</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-設定伺服器快取控制"><a href="#2-設定伺服器快取控制" class="headerlink" title="2. 設定伺服器快取控制"></a>2. 設定伺服器快取控制</h3><p>在伺服器端設定適當的 HTTP 標頭，可以告訴瀏覽器不要快取特定檔案：</p>
<pre class="line-numbers language-nginx" data-language="nginx"><code class="language-nginx"><span class="token comment"># Nginx 設定範例</span>
<span class="token directive"><span class="token keyword">location</span> /components/</span> <span class="token punctuation">&#123;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Cache-Control <span class="token string">"no-cache, no-store, must-revalidate"</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Pragma <span class="token string">"no-cache"</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> Expires <span class="token string">"0"</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-使用-Webpack-動態引入"><a href="#3-使用-Webpack-動態引入" class="headerlink" title="3. 使用 Webpack 動態引入"></a>3. 使用 Webpack 動態引入</h3><p>如果你的專案使用 Webpack，可以改用動態引入的方式：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 改寫前</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'x-spit'</span><span class="token punctuation">,</span> <span class="token function">httpVueLoader</span><span class="token punctuation">(</span><span class="token string">'DrainFacility/SurveyPit.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 改寫後</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'x-spit'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./DrainFacility/SurveyPit.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-使用-Vue-的-keep-alive-控制緩存"><a href="#4-使用-Vue-的-keep-alive-控制緩存" class="headerlink" title="4. 使用 Vue 的 keep-alive 控制緩存"></a>4. 使用 Vue 的 keep-alive 控制緩存</h3><p>如果你想要更細緻地控制組件的緩存行為，可以使用 Vue 內建的 <code>keep-alive</code> 組件：</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span> <span class="token attr-name">:include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>['ComponentA', 'ComponentB']<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-開發時的實用技巧"><a href="#5-開發時的實用技巧" class="headerlink" title="5. 開發時的實用技巧"></a>5. 開發時的實用技巧</h3><ol>
<li><p>使用 Chrome 的開發者工具：</p>
<ul>
<li>勾選 Network 頁籤中的 “Disable cache”</li>
<li>或按住重新整理按鈕，選擇「強制重新整理」(Ctrl + F5)</li>
</ul>
</li>
<li><p>在 Vue CLI 專案中設定 devServer：</p>
</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token string-property property">'Cache-Control'</span><span class="token operator">:</span> <span class="token string">'no-cache, no-store, must-revalidate'</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><p>組件緩存問題雖然困擾，但有多種解決方案可以選擇。建議根據專案的實際需求，選擇最適合的方案：</p>
<ul>
<li>如果是開發階段，使用時間戳或禁用快取是最直接的解決方案</li>
<li>如果是生產環境，則建議使用版本號或 Webpack 的動態引入</li>
<li>若需要更細緻的緩存控制，可以考慮使用 <code>keep-alive</code> 組件</li>
</ul>
<p>記住，快取機制本身是為了提升效能而存在的，我們的目標是在開發便利性和執行效能之間取得平衡。</p>
<h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><ul>
<li>Vue.js 官方文件</li>
<li>Vue Router 文件</li>
<li>MDN Web 文件（HTTP 快取）</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/09/12/cm82sqley000oa497ezx8gh9f/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/12/cm82sqley000oa497ezx8gh9f/" class="post-title-link" itemprop="url">EmEditor 介紹與 JSON 壓縮/解壓縮教程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-09-12 09:48:54" itemprop="dateCreated datePublished" datetime="2024-09-12T09:48:54+08:00">2024-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:48:28" itemprop="dateModified" datetime="2024-11-27T14:48:28+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%BB%9F%E9%AB%94%E4%BB%8B%E7%B4%B9/" itemprop="url" rel="index"><span itemprop="name">軟體介紹</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="EmEditor-介紹與-JSON-壓縮-解壓縮教程"><a href="#EmEditor-介紹與-JSON-壓縮-解壓縮教程" class="headerlink" title="EmEditor 介紹與 JSON 壓縮/解壓縮教程"></a>EmEditor 介紹與 JSON 壓縮/解壓縮教程</h1><h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>工作的時候拿到了超過1G以上的JSON檔，使用VSCODE、跟NotePad++雖然都能開啟，但是速度真的慢，而且JSON也因為太大無法做格式化動作，於是開始找能開啟大檔案的軟體。</p>
<h2 id="1-EmEditor-軟體介紹"><a href="#1-EmEditor-軟體介紹" class="headerlink" title="1. EmEditor 軟體介紹"></a>1. EmEditor 軟體介紹</h2><p>EmEditor 是一款強大的文本編輯器,專為處理大型文件而設計。以下是其主要特點：</p>
<ul>
<li><strong>高性能</strong>：能夠輕鬆處理超過 248GB 的大型文件。</li>
<li><strong>多功能</strong>：支持多種編碼,語法高亮,正則表達式等。</li>
<li><strong>可定制</strong>：提供豐富的插件和自定義選項。</li>
<li><strong>CSV/TSV 支持</strong>：優秀的電子表格處理能力。</li>
<li><strong>宏和腳本</strong>：支持錄製宏和執行 JavaScript 腳本。</li>
<li><strong>多語言支持</strong>：包括中文在內的多種語言界面。</li>
</ul>
<h3 id="對大型-JSON-文件的優勢"><a href="#對大型-JSON-文件的優勢" class="headerlink" title="對大型 JSON 文件的優勢"></a>對大型 JSON 文件的優勢</h3><ul>
<li>可以快速打開和編輯大型 JSON 文件。</li>
<li>提供 JSON 格式化和壓縮功能。</li>
<li>支持通過腳本進行高級 JSON 操作。</li>
</ul>
<h2 id="2-使用-JavaScript-腳本進行-JSON-壓縮與解壓縮"><a href="#2-使用-JavaScript-腳本進行-JSON-壓縮與解壓縮" class="headerlink" title="2. 使用 JavaScript 腳本進行 JSON 壓縮與解壓縮"></a>2. 使用 JavaScript 腳本進行 JSON 壓縮與解壓縮</h2><p>EmEditor 允許用戶使用 JavaScript 腳本來增強其功能。以下是如何編寫和使用腳本來壓縮和解壓縮 JSON：</p>
<h3 id="JSON-壓縮腳本"><a href="#JSON-壓縮腳本" class="headerlink" title="JSON 壓縮腳本"></a>JSON 壓縮腳本</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">document<span class="token punctuation">.</span>selection<span class="token punctuation">.</span><span class="token function">SelectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>selection<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>selection<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>這個腳本的工作原理：</p>
<ol>
<li><code>document.selection.SelectAll()</code> 選中所有文本。</li>
<li><code>JSON.parse()</code> 將文本解析為 JavaScript 對象。</li>
<li><code>JSON.stringify()</code> 將對象轉換回 JSON 字符串,但不帶任何格式化。</li>
<li>結果替換了原有的文本,實現了 JSON 的壓縮。</li>
</ol>
<h3 id="JSON-解壓縮（格式化）腳本"><a href="#JSON-解壓縮（格式化）腳本" class="headerlink" title="JSON 解壓縮（格式化）腳本"></a>JSON 解壓縮（格式化）腳本</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">document<span class="token punctuation">.</span>selection<span class="token punctuation">.</span><span class="token function">SelectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>selection<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>selection<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>這個腳本的工作原理：</p>
<ol>
<li>選中所有文本並解析為 JavaScript 對象,與壓縮腳本相同。</li>
<li><code>JSON.stringify()</code> 中的額外參數：<ul>
<li><code>null</code> 表示不使用替換函數。</li>
<li><code>&#39;\t&#39;</code> 指定使用製表符進行縮進,使 JSON 更易讀。</li>
</ul>
</li>
</ol>
<h2 id="3-在-EmEditor-中使用腳本"><a href="#3-在-EmEditor-中使用腳本" class="headerlink" title="3. 在 EmEditor 中使用腳本"></a>3. 在 EmEditor 中使用腳本</h2><ol>
<li>打開 EmEditor 並載入您的 JSON 文件。</li>
<li>在新開的頁面貼上相應的腳本。</li>
<li>保存成jsee檔,給它一個描述性的名稱（如 “JSON壓縮” 或 “JSON解壓縮”）。</li>
<li>點擊「巨集」&gt;「自訂」。<br><img src="20240912095550018.png"></li>
<li>點擊添加，將剛剛寫的jsee檔添加。<br><img src="20240912095851185.png"></li>
</ol>
<h2 id="4-實用技巧"><a href="#4-實用技巧" class="headerlink" title="4. 實用技巧"></a>4. 實用技巧</h2><ul>
<li>為這些腳本分配快捷鍵,以便更快地執行。</li>
<li>在處理非常大的文件時,可能需要增加 EmEditor 的內存使用限制。</li>
<li>使用 EmEditor 的「大檔案控制器」功能來更有效地處理大型 JSON 文件。</li>
</ul>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>EmEditor 結合 JavaScript 腳本為處理大型 JSON 文件提供了強大而靈活的解決方案。通過掌握這些技巧,您可以輕鬆地對 JSON 數據進行壓縮、解壓縮和格式化,大大提高工作效率。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/09/11/cm82sqlgg003xa4979e027r70/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/11/cm82sqlgg003xa4979e027r70/" class="post-title-link" itemprop="url">Vue3 SFC Loader 深入解析：輕鬆加載</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-09-11 10:36:25" itemprop="dateCreated datePublished" datetime="2024-09-11T10:36:25+08:00">2024-09-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:34:46" itemprop="dateModified" datetime="2024-11-27T14:34:46+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/" itemprop="url" rel="index"><span itemprop="name">程式教學</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Vue3-SFC-Loader-深入解析：輕鬆加載-Vue-單文件組件"><a href="#Vue3-SFC-Loader-深入解析：輕鬆加載-Vue-單文件組件" class="headerlink" title="Vue3 SFC Loader 深入解析：輕鬆加載 Vue 單文件組件"></a>Vue3 SFC Loader 深入解析：輕鬆加載 Vue 單文件組件</h1><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>在Vue.js開發中,單文件組件(Single File Components, SFC)是一種廣受歡迎的文件格式,它允許我們將組件的模板、邏輯和樣式封裝在一個文件中。然而,在某些場景下,我們可能需要在運行時動態加載這些.vue文件,而不是在構建階段將它們編譯為JavaScript。這就是vue3-sfc-loader發揮作用的地方。</p>
<p>本文將深入探討vue3-sfc-loader,介紹它的功能、使用方法,以及在實際項目中的應用場景。</p>
<h2 id="什麼是vue3-sfc-loader"><a href="#什麼是vue3-sfc-loader" class="headerlink" title="什麼是vue3-sfc-loader?"></a>什麼是vue3-sfc-loader?</h2><p>vue3-sfc-loader是一個強大的工具,允許我們在瀏覽器中直接加載和使用Vue 3單文件組件(.vue文件),而無需預編譯。這為開發人員提供了更大的靈活性,特別是在以下場景中:</p>
<ol>
<li>動態加載組件</li>
<li>在線代碼編輯器</li>
<li>不使用構建工具的小型項目</li>
<li>原型設計和快速開發</li>
</ol>
<h2 id="安裝和基本使用"><a href="#安裝和基本使用" class="headerlink" title="安裝和基本使用"></a>安裝和基本使用</h2><p>首先,我們需要安裝vue3-sfc-loader:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> vue3-sfc-loader<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>接下來,讓我們看一個基本的使用示例:</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Vue3 SFC Loader Example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/vue@3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/vue3-sfc-loader<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> loadModule <span class="token punctuation">&#125;</span> <span class="token operator">=</span> window<span class="token punctuation">[</span><span class="token string">'vue3-sfc-loader'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">moduleCache</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token literal-property property">vue</span><span class="token operator">:</span> Vue
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token keyword">async</span> <span class="token function">getFile</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>res<span class="token punctuation">.</span>ok <span class="token punctuation">)</span>
                    <span class="token keyword">throw</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>statusText <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> res <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
                    <span class="token function-variable function">getContentData</span><span class="token operator">:</span> <span class="token parameter">asBinary</span> <span class="token operator">=></span> asBinary <span class="token operator">?</span> res<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token function">addStyle</span><span class="token punctuation">(</span><span class="token parameter">textContent</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">const</span> style <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> textContent <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">const</span> ref <span class="token operator">=</span> document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>style<span class="token punctuation">,</span> ref<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token string-property property">'my-component'</span><span class="token operator">:</span> Vue<span class="token punctuation">.</span><span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">loadModule</span><span class="token punctuation">(</span><span class="token string">'./MyComponent.vue'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">'&lt;my-component>&lt;/my-component>'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在這個例子中,我們使用vue3-sfc-loader動態加載了一個名為MyComponent.vue的組件。</p>
<h2 id="深入理解配置選項"><a href="#深入理解配置選項" class="headerlink" title="深入理解配置選項"></a>深入理解配置選項</h2><p>vue3-sfc-loader提供了多個配置選項,讓我們可以自定義加載過程:</p>
<ol>
<li><code>moduleCache</code>: 用於緩存已加載的模塊,提高性能。</li>
<li><code>getFile</code>: 一個異步函數,用於獲取.vue文件的內容。</li>
<li><code>addStyle</code>: 一個函數,用於將組件的樣式添加到DOM中。</li>
<li><code>handleModule</code>: 可選函數,用於自定義模塊的處理方式。</li>
<li><code>log</code>: 可選函數,用於自定義日誌輸出。</li>
</ol>
<h2 id="高級使用技巧"><a href="#高級使用技巧" class="headerlink" title="高級使用技巧"></a>高級使用技巧</h2><h3 id="1-動態路由組件"><a href="#1-動態路由組件" class="headerlink" title="1. 動態路由組件"></a>1. 動態路由組件</h3><p>vue3-sfc-loader非常適合實現動態路由組件。例如:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/dynamic-page'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Vue<span class="token punctuation">.</span><span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">loadModule</span><span class="token punctuation">(</span><span class="token string">'./DynamicPage.vue'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-插件系統"><a href="#2-插件系統" class="headerlink" title="2. 插件系統"></a>2. 插件系統</h3><p>您可以使用vue3-sfc-loader來實現一個簡單的插件系統,允許用戶上傳自己的Vue組件:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">loadUserPlugin</span><span class="token punctuation">(</span><span class="token parameter">pluginUrl</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> Vue<span class="token punctuation">.</span><span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">loadModule</span><span class="token punctuation">(</span>pluginUrl<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="3-在線代碼編輯器"><a href="#3-在線代碼編輯器" class="headerlink" title="3. 在線代碼編輯器"></a>3. 在線代碼編輯器</h3><p>vue3-sfc-loader可以用來構建在線Vue代碼編輯器,實時編譯和預覽用戶編寫的Vue組件:</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">compileAndRun</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>code<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'text/plain'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">loadModule</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> module<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="性能考慮"><a href="#性能考慮" class="headerlink" title="性能考慮"></a>性能考慮</h2><p>雖然vue3-sfc-loader提供了很大的靈活性,但它也帶來了一些性能開銷。在運行時編譯組件會增加初始加載時間和內存使用。因此,在大型生產應用中,應謹慎使用此方法,並考慮以下優化策略:</p>
<ol>
<li>實施有效的緩存機制</li>
<li>只在必要時使用動態加載</li>
<li>考慮使用服務器端渲染(SSR)來改善初始加載性能</li>
</ol>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>vue3-sfc-loader為Vue 3開發者提供了一個強大的工具,使得在運行時動態加載和使用.vue文件成為可能。它特別適用於需要高度靈活性的場景,如動態主題、插件系統或在線代碼編輯器。</p>
<p>然而,開發者應該權衡使用vue3-sfc-loader的優勢和潛在的性能影響。在大多數情況下,預編譯組件仍然是推薦的方法。但對於那些需要極高靈活性的特定用例,vue3-sfc-loader無疑是一個值得考慮的強大工具。</p>
<p>通過深入了解和合理使用vue3-sfc-loader,我們可以在Vue 3項目中實現更大的靈活性和創新性,同時保持良好的性能和用戶體驗。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/09/05/cm82sqlei0004a497a63z8lpx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/05/cm82sqlei0004a497a63z8lpx/" class="post-title-link" itemprop="url">C# 常用命名空間參考指南</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-09-05 18:36:45" itemprop="dateCreated datePublished" datetime="2024-09-05T18:36:45+08:00">2024-09-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:39:50" itemprop="dateModified" datetime="2024-11-27T14:39:50+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/" itemprop="url" rel="index"><span itemprop="name">程式教學</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="C-常用命名空間參考指南"><a href="#C-常用命名空間參考指南" class="headerlink" title="C# 常用命名空間參考指南"></a>C# 常用命名空間參考指南</h1><p>筆記一些常用到的命名空間</p>
<h2 id="1-基礎核心命名空間"><a href="#1-基礎核心命名空間" class="headerlink" title="1. 基礎核心命名空間"></a>1. 基礎核心命名空間</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>                     <span class="token comment">// 基礎類型、例外處理</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>         <span class="token comment">// 非泛型集合</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span> <span class="token comment">// 泛型集合</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>               <span class="token comment">// LINQ 查詢</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>ComponentModel</span><span class="token punctuation">;</span>      <span class="token comment">// 資料綁定、型別轉換</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>               <span class="token comment">// 文字處理</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>RegularExpressions</span><span class="token punctuation">;</span> <span class="token comment">// 正則表達式</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Globalization</span><span class="token punctuation">;</span>      <span class="token comment">// 地區和文化資訊</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Configuration</span><span class="token punctuation">;</span>      <span class="token comment">// 應用程式配置</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>Serialization</span><span class="token punctuation">;</span> <span class="token comment">// 序列化</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-檔案與-I-O-處理"><a href="#2-檔案與-I-O-處理" class="headerlink" title="2. 檔案與 I/O 處理"></a>2. 檔案與 I/O 處理</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>                 <span class="token comment">// 檔案與目錄操作</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Compression</span><span class="token punctuation">;</span>     <span class="token comment">// 檔案壓縮</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Ports</span><span class="token punctuation">;</span>          <span class="token comment">// 序列埠通訊</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Xml</span><span class="token punctuation">;</span>               <span class="token comment">// XML 處理</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>          <span class="token comment">// LINQ to XML</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>Serialization</span><span class="token punctuation">;</span> <span class="token comment">// XML 序列化</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>Schema</span><span class="token punctuation">;</span>        <span class="token comment">// XML Schema</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-網路與-Web-開發"><a href="#3-網路與-Web-開發" class="headerlink" title="3. 網路與 Web 開發"></a>3. 網路與 Web 開發</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net</span><span class="token punctuation">;</span>               <span class="token comment">// 基礎網路功能</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>          <span class="token comment">// HTTP 客戶端</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Mail</span><span class="token punctuation">;</span>          <span class="token comment">// 電子郵件</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Sockets</span><span class="token punctuation">;</span>       <span class="token comment">// TCP/IP 網路</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web</span><span class="token punctuation">;</span>               <span class="token comment">// Web 應用程式</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>          <span class="token comment">// Web API</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>Mvc</span><span class="token punctuation">;</span>           <span class="token comment">// ASP.NET MVC</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore</span><span class="token punctuation">;</span>     <span class="token comment">// .NET Core Web 應用</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>SignalR</span><span class="token punctuation">;</span> <span class="token comment">// 即時通訊</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Authentication</span><span class="token punctuation">;</span> <span class="token comment">// 身份驗證</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Authorization</span><span class="token punctuation">;</span>  <span class="token comment">// 授權</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>DependencyInjection</span><span class="token punctuation">;</span> <span class="token comment">// 依賴注入</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Configuration</span><span class="token punctuation">;</span>  <span class="token comment">// 配置</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Logging</span><span class="token punctuation">;</span>        <span class="token comment">// 日誌</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="4-資料庫存取"><a href="#4-資料庫存取" class="headerlink" title="4. 資料庫存取"></a>4. 資料庫存取</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>              <span class="token comment">// 資料庫通用功能</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient</span><span class="token punctuation">;</span>    <span class="token comment">// SQL Server 連線</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Entity</span><span class="token punctuation">;</span>       <span class="token comment">// Entity Framework</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>EntityFrameworkCore</span><span class="token punctuation">;</span> <span class="token comment">// EF Core</span>
<span class="token keyword">using</span> <span class="token namespace">Dapper</span><span class="token punctuation">;</span>                  <span class="token comment">// Dapper ORM</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Sqlite</span><span class="token punctuation">;</span>   <span class="token comment">// SQLite</span>
<span class="token keyword">using</span> <span class="token namespace">Npgsql</span><span class="token punctuation">;</span>                  <span class="token comment">// PostgreSQL</span>
<span class="token keyword">using</span> <span class="token namespace">MongoDB<span class="token punctuation">.</span>Driver</span><span class="token punctuation">;</span>          <span class="token comment">// MongoDB</span>
<span class="token keyword">using</span> <span class="token namespace">StackExchange<span class="token punctuation">.</span>Redis</span><span class="token punctuation">;</span>     <span class="token comment">// Redis</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="5-訊息佇列與事件匯流排"><a href="#5-訊息佇列與事件匯流排" class="headerlink" title="5. 訊息佇列與事件匯流排"></a>5. 訊息佇列與事件匯流排</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">RabbitMQ<span class="token punctuation">.</span>Client</span><span class="token punctuation">;</span>         <span class="token comment">// RabbitMQ</span>
<span class="token keyword">using</span> <span class="token namespace">Azure<span class="token punctuation">.</span>Messaging<span class="token punctuation">.</span>ServiceBus</span><span class="token punctuation">;</span> <span class="token comment">// Azure Service Bus</span>
<span class="token keyword">using</span> <span class="token namespace">MassTransit</span><span class="token punctuation">;</span>             <span class="token comment">// MassTransit</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>EventHubs</span><span class="token punctuation">;</span> <span class="token comment">// Azure Event Hubs</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="6-雲端服務整合"><a href="#6-雲端服務整合" class="headerlink" title="6. 雲端服務整合"></a>6. 雲端服務整合</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">Azure<span class="token punctuation">.</span>Storage<span class="token punctuation">.</span>Blobs</span><span class="token punctuation">;</span>     <span class="token comment">// Azure Blob Storage</span>
<span class="token keyword">using</span> <span class="token namespace">Azure<span class="token punctuation">.</span>Identity</span><span class="token punctuation">;</span>          <span class="token comment">// Azure 身份認證</span>
<span class="token keyword">using</span> <span class="token namespace">Amazon<span class="token punctuation">.</span>S3</span><span class="token punctuation">;</span>               <span class="token comment">// AWS S3</span>
<span class="token keyword">using</span> <span class="token namespace">Amazon<span class="token punctuation">.</span>SQS</span><span class="token punctuation">;</span>              <span class="token comment">// AWS SQS</span>
<span class="token keyword">using</span> <span class="token namespace">Google<span class="token punctuation">.</span>Cloud<span class="token punctuation">.</span>Storage<span class="token punctuation">.</span>V1</span><span class="token punctuation">;</span> <span class="token comment">// Google Cloud Storage</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="7-效能與監控"><a href="#7-效能與監控" class="headerlink" title="7. 效能與監控"></a>7. 效能與監控</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Diagnostics</span><span class="token punctuation">;</span>       <span class="token comment">// 效能監控、事件記錄</span>
<span class="token keyword">using</span> <span class="token namespace">OpenTelemetry</span><span class="token punctuation">;</span>           <span class="token comment">// 分散式追蹤</span>
<span class="token keyword">using</span> <span class="token namespace">OpenTelemetry<span class="token punctuation">.</span>Metrics</span><span class="token punctuation">;</span>   <span class="token comment">// 指標收集</span>
<span class="token keyword">using</span> <span class="token namespace">App<span class="token punctuation">.</span>Metrics</span><span class="token punctuation">;</span>             <span class="token comment">// 應用程式指標</span>
<span class="token keyword">using</span> <span class="token namespace">Prometheus</span><span class="token punctuation">;</span>              <span class="token comment">// Prometheus 監控</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="8-快取"><a href="#8-快取" class="headerlink" title="8. 快取"></a>8. 快取</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Caching<span class="token punctuation">.</span>Memory</span><span class="token punctuation">;</span>  <span class="token comment">// 記憶體快取</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Caching<span class="token punctuation">.</span>Redis</span><span class="token punctuation">;</span>   <span class="token comment">// Redis 快取</span>
<span class="token keyword">using</span> <span class="token namespace">LazyCache</span><span class="token punctuation">;</span>               <span class="token comment">// 延遲快取</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h2 id="9-背景工作"><a href="#9-背景工作" class="headerlink" title="9. 背景工作"></a>9. 背景工作</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">Hangfire</span><span class="token punctuation">;</span>               <span class="token comment">// 背景工作排程</span>
<span class="token keyword">using</span> <span class="token namespace">Quartz</span><span class="token punctuation">;</span>                 <span class="token comment">// 工作排程</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Hosting</span><span class="token punctuation">;</span> <span class="token comment">// 託管服務</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Reactive</span><span class="token punctuation">;</span>        <span class="token comment">// 反應式程式設計</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Reactive<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>   <span class="token comment">// Rx.NET</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="10-測試相關"><a href="#10-測試相關" class="headerlink" title="10. 測試相關"></a>10. 測試相關</h2><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>VisualStudio<span class="token punctuation">.</span>TestTools<span class="token punctuation">.</span>UnitTesting</span><span class="token punctuation">;</span> <span class="token comment">// MSTest</span>
<span class="token keyword">using</span> <span class="token namespace">Xunit</span><span class="token punctuation">;</span>                  <span class="token comment">// xUnit</span>
<span class="token keyword">using</span> <span class="token namespace">NUnit<span class="token punctuation">.</span>Framework</span><span class="token punctuation">;</span>        <span class="token comment">// NUnit</span>
<span class="token keyword">using</span> <span class="token namespace">Moq</span><span class="token punctuation">;</span>                   <span class="token comment">// Mock 框架</span>
<span class="token keyword">using</span> <span class="token namespace">FluentAssertions</span><span class="token punctuation">;</span>      <span class="token comment">// 流暢的斷言</span>
<span class="token keyword">using</span> <span class="token namespace">AutoFixture</span><span class="token punctuation">;</span>           <span class="token comment">// 測試資料產生</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="使用情境範例"><a href="#使用情境範例" class="headerlink" title="使用情境範例"></a>使用情境範例</h2><h3 id="1-檔案操作"><a href="#1-檔案操作" class="headerlink" title="1. 檔案操作"></a>1. 檔案操作</h3><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>

<span class="token comment">// 讀取文字檔</span>
<span class="token class-name"><span class="token keyword">string</span></span> content <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">ReadAllText</span><span class="token punctuation">(</span><span class="token string">"file.txt"</span><span class="token punctuation">,</span> Encoding<span class="token punctuation">.</span>UTF8<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 寫入檔案</span>
File<span class="token punctuation">.</span><span class="token function">WriteAllText</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span> <span class="token string">"內容"</span><span class="token punctuation">,</span> Encoding<span class="token punctuation">.</span>UTF8<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-資料庫操作"><a href="#2-資料庫操作" class="headerlink" title="2. 資料庫操作"></a>2. 資料庫操作</h3><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">string</span></span> connectionString <span class="token operator">=</span> <span class="token string">"連線字串"</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    connection<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 執行 SQL 命令</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-HTTP-請求"><a href="#3-HTTP-請求" class="headerlink" title="3. HTTP 請求"></a>3. HTTP 請求</h3><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http</span><span class="token punctuation">;</span>

<span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> response <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetAsync</span><span class="token punctuation">(</span><span class="token string">"https://api.example.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">string</span></span> content <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>Content<span class="token punctuation">.</span><span class="token function">ReadAsStringAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-JSON-處理"><a href="#4-JSON-處理" class="headerlink" title="4. JSON 處理"></a>4. JSON 處理</h3><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">Newtonsoft<span class="token punctuation">.</span>Json</span><span class="token punctuation">;</span>

<span class="token comment">// 序列化</span>
<span class="token class-name"><span class="token keyword">string</span></span> json <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token function">SerializeObject</span><span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 反序列化</span>
<span class="token class-name"><span class="token keyword">var</span></span> obj <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeserializeObject</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Type<span class="token punctuation">></span></span></span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="4-依賴注入設定"><a href="#4-依賴注入設定" class="headerlink" title="4. 依賴注入設定"></a>4. 依賴注入設定</h3><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>DependencyInjection</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddScoped</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IUserService<span class="token punctuation">,</span> UserService<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ICacheService<span class="token punctuation">,</span> RedisCacheService<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddTransient</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IEmailSender<span class="token punctuation">,</span> SmtpEmailSender<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="5-非同步操作與取消"><a href="#5-非同步操作與取消" class="headerlink" title="5. 非同步操作與取消"></a>5. 非同步操作與取消</h3><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">ProcessDataAsync</span><span class="token punctuation">(</span><span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">WhenAll</span><span class="token punctuation">(</span>
        <span class="token function">Task1Async</span><span class="token punctuation">(</span>cancellationToken<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">Task2Async</span><span class="token punctuation">(</span>cancellationToken<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="6-分散式快取"><a href="#6-分散式快取" class="headerlink" title="6. 分散式快取"></a>6. 分散式快取</h3><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Caching<span class="token punctuation">.</span>Distributed</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">></span></span> <span class="token function">GetCachedDataAsync</span><span class="token punctuation">(</span><span class="token class-name">IDistributedCache</span> cache<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> cache<span class="token punctuation">.</span><span class="token function">GetStringAsync</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">??</span> 
           <span class="token keyword">await</span> <span class="token function">FetchAndCacheDataAsync</span><span class="token punctuation">(</span>cache<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="最佳實踐建議"><a href="#最佳實踐建議" class="headerlink" title="最佳實踐建議"></a>最佳實踐建議</h2><ol>
<li><p>命名空間組織</p>
<ul>
<li>按功能領域組織命名空間</li>
<li>避免循環依賴</li>
<li>保持命名空間結構扁平化</li>
</ul>
</li>
<li><p>效能考量</p>
<ul>
<li>使用 <code>global using</code> 統一管理常用命名空間</li>
<li>避免在熱路徑中動態載入組件</li>
<li>注意命名空間引用對編譯時間的影響</li>
</ul>
</li>
<li><p>相容性管理</p>
<ul>
<li>使用 <code>#if</code> 條件編譯符號處理不同框架版本</li>
<li>定期更新套件版本</li>
<li>維護最小相依性原則</li>
</ul>
</li>
<li><p>安全性考量</p>
<ul>
<li>優先使用最新的安全性API</li>
<li>避免使用已棄用的命名空間</li>
<li>遵循最小權限原則</li>
</ul>
</li>
<li><p>套件管理</p>
<ul>
<li>使用中央化的套件版本管理</li>
<li>定期審查第三方套件的安全性更新</li>
<li>建立套件使用規範</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/09/05/cm82sqled0001a497a8loafgw/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/05/cm82sqled0001a497a8loafgw/" class="post-title-link" itemprop="url">2024年CSS終於實現垂直置中</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-09-05 11:44:37" itemprop="dateCreated datePublished" datetime="2024-09-05T11:44:37+08:00">2024-09-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:33:58" itemprop="dateModified" datetime="2024-11-27T14:33:58+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/" itemprop="url" rel="index"><span itemprop="name">程式教學</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="2024年CSS終於實現垂直置中"><a href="#2024年CSS終於實現垂直置中" class="headerlink" title="2024年CSS終於實現垂直置中"></a>2024年CSS終於實現垂直置中</h1><p>在2024年，<code>align-content</code>終於可以在塊級佈局中運作了。只需<strong>一個CSS屬性</strong>就能實現垂直置中，而不需使用Flexbox或Grid。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">align-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span>align-content<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span> 現在可以直接使用了!
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://caniuse.com/mdn-css_properties_align-content_block_context">支援情況</a>:<br>Chrome: 123 | Firefox: 125 | Safari: 17.4</p>
<p>可以看到只支援比較新的瀏覽器版本，所以使用上還是得考慮一下，總的來說，雖然我們會很興奮地看到新的 CSS 特性出現，但在實際開發中，我們需要平衡新特性的使用和對舊版瀏覽器的支援。通常，我們會採用漸進式增強的策略，確保基本功能在所有環境中都能正常運作，同時為支援新特性的瀏覽器提供更好的體驗。。</p>
<h2 id="有什麼新變化"><a href="#有什麼新變化" class="headerlink" title="有什麼新變化?"></a>有什麼新變化?</h2><p>CSS對齊的現況是需要切換到<em>flexbox</em>或<em>grid</em>佈局，因為<code>align-content</code>在預設佈局(<em>flow</em>)中不起作用。在2024年，瀏覽器<a target="_blank" rel="noopener" href="https://web.dev/blog/align-content-block">實作了</a>流式佈局的<code>align-content</code>。這帶來一些好處:</p>
<ul>
<li>你不需要使用flexbox或grid，只需要一個CSS屬性就能實現對齊。</li>
<li>因此，內容不需要包裝在一個div中。</li>
</ul>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- 可以運作 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span> <span class="token property">align-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  內容。
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- 失敗! --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span> <span class="token property">align-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  包含<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">></span></span>多個<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">></span></span>節點的內容。
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- 使用內容包裝器可以運作 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span> <span class="token property">align-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!-- 額外的包裝器 --></span>
    包含<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">></span></span>多個<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">></span></span>節點的內容。
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- 不需要內容包裝器就可以運作 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">align-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  包含<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">></span></span>多個<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">></span></span>節點的內容。
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>經過幾十年的進步，CSS終於有了一個<strong>單一屬性</strong>來控制垂直對齊，這真是太棒了!</p>
<h2 id="垂直置中-歷史回顧"><a href="#垂直置中-歷史回顧" class="headerlink" title="垂直置中 - 歷史回顧"></a>垂直置中 - 歷史回顧</h2><p>瀏覽器很有趣，像對齊這樣的基本需求在很長一段時間內都沒有簡單的解決方案。以下是如何置中內容:</p>
<p>以下是在瀏覽器中如何<em>垂直</em>置中(<em>水平</em>置中是另一個話題):</p>
<h3 id="方法1-表格單元格"><a href="#方法1-表格單元格" class="headerlink" title="方法1:表格單元格"></a>方法1:表格單元格</h3><p>有4種主要佈局:flow(預設)、table、flexbox、grid。如何對齊內容取決於容器的佈局。flexbox和grid是後來才加入的，所以table是最早的選擇。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> table<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> table-cell<span class="token punctuation">;</span> <span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
    內容。
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以僅透過CSS召喚出一個表格，但需要這樣一個間接方法實在是一種恥辱。</p>
<h3 id="方法2-絕對定位"><a href="#方法2-絕對定位" class="headerlink" title="方法2:絕對定位"></a>方法2:絕對定位</h3><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span> <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
    內容。
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>這種方法使用絕對定位來繞過佈局，因為流式佈局無法幫助我們:</p>
<ol>
<li>用<code>position: relative</code>標記參考容器。</li>
<li>用<code>position: absolute; top: 50%</code>將內容邊緣放在中心。</li>
<li>用<code>transform: translateY(-50%)</code>將內容中心偏移到邊緣。</li>
</ol>
<p>此方法的缺點有：</p>
<ol>
<li>複雜性：這個方法需要多個 CSS 屬性組合，不夠直觀。</li>
<li>破壞文檔流：使用絕對定位會將元素從正常文檔流中移除，可能導致佈局問題。</li>
<li>需要額外的包裝元素：這個方法通常需要一個額外的容器元素。</li>
<li>不靈活：在某些情況下，這種方法可能不適用，特別是當容器高度不固定時。</li>
<li>性能考慮：使用 transform 可能在某些情況下引起性能問題。</li>
<li>不符合語義：這種方法使用了與內容語義無關的 CSS 技巧來實現佈局。</li>
</ol>
<p>不過這個方法還是很多開發者在使用，因為</p>
<ol>
<li>廣泛支援：這個方法在絕大多數瀏覽器中都能正常工作，包括較舊的版本。</li>
<li>可靠性：一旦掌握，這個方法在大多數情況下都能可靠地工作。</li>
<li>靈活性：可以輕易調整以適應不同的情況，如水平置中。</li>
<li>習慣：許多開發者已經習慣了這種方法，並能快速實現。</li>
<li>相容性好：不依賴於新的 CSS 特性，因此在各種環境中都能使用。</li>
<li>問題解決：儘管不完美，但它解決了一個常見的佈局問題。</li>
</ol>
<h3 id="方法3-行內內容"><a href="#方法3-行內內容" class="headerlink" title="方法3:行內內容"></a>方法3:行內內容</h3><p>雖然流式佈局不能幫助內容對齊，但它允許在行內進行垂直對齊。那麼為什麼不讓一行和容器一樣高呢?</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  ::before
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>內容。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-css" data-language="css"><code class="language-css"><span class="token selector">.container::before</span> <span class="token punctuation">&#123;</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
  <span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token selector">.content</span> <span class="token punctuation">&#123;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
  <span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>這有一些缺陷:除了犧牲一個偽元素外，開頭還有一個零寬度的<a target="_blank" rel="noopener" href="https://christopheraue.net/design/vertical-align#:~:text=strut">“支柱”字元</a>可能會搞亂東西。</p>
<h3 id="方法4-單行flexbox"><a href="#方法4-單行flexbox" class="headerlink" title="方法4:單行flexbox"></a>方法4:單行flexbox</h3><p>flexbox在Web出現20年後才廣泛可用。它有兩種模式:單行和多行。在單行模式(預設)下，該行填滿垂直空間，<code>align-items</code>在行內對齊內容。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span> <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>內容。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>或者，讓行變成列，用<code>justify-content</code>對齊項目。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span> <span class="token property">flex-flow</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span> <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>內容。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="方法5-多行flexbox"><a href="#方法5-多行flexbox" class="headerlink" title="方法5:多行flexbox"></a>方法5:多行flexbox</h3><p>在多行flexbox中，行不再填滿垂直空間，所以可以用<code>align-content</code>對齊只有1個項目的行。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span> <span class="token property">flex-flow</span><span class="token punctuation">:</span> row wrap<span class="token punctuation">;</span> <span class="token property">align-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>內容。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="方法6-網格內容"><a href="#方法6-網格內容" class="headerlink" title="方法6:網格內容"></a>方法6:網格內容</h3><p>網格出現得更晚。對齊變得更簡單。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span> <span class="token property">align-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>內容。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="方法7-網格單元格"><a href="#方法7-網格單元格" class="headerlink" title="方法7:網格單元格"></a>方法7:網格單元格</h3><p>注意與前一種方法的細微差別:</p>
<ul>
<li><code>align-content</code>將<em>單元格</em>相對於<em>容器</em>置中。</li>
<li><code>align-items</code>將<em>內容</em>相對於<em>單元格</em>置中，而<em>單元格</em>會拉伸以適應<em>容器</em>。</li>
</ul>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span> <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>內容。<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>似乎有很多方法可以做同樣的事情。</p>
<h3 id="方法8-自動外邊距"><a href="#方法8-自動外邊距" class="headerlink" title="方法8:自動外邊距"></a>方法8:自動外邊距</h3><p>在流式佈局中，<code>margin:auto</code>可以水平置中，但不能垂直置中。flexbox和Grid沒有這個問題。</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">margin-block</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
    內容。
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>不過，我還是很困惑為什麼要設計邊距來控制對齊。</p>
<h3 id="方法9-2024年的這篇文章"><a href="#方法9-2024年的這篇文章" class="headerlink" title="方法9:2024年的這篇文章"></a>方法9:2024年的這篇文章</h3><p>為什麼瀏覽器一開始就不加入這個功能呢?</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">align-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span>align-content<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span> 現在可以直接使用了!
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>方法1中的表格單元格，像這種方法一樣，也不需要內容包裝器(儘管它需要一個表格包裝器)。我們又回到了起點!</p>
<p>不過使用上要看瀏覽器是否支援，可以使用以下策略：</p>
<ol>
<li>使用特性檢測：<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'alignContent'</span> <span class="token keyword">in</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 使用新的 align-content 方法</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 使用備用方法</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li>使用 CSS @supports：<pre class="line-numbers language-CSS" data-language="CSS"><code class="language-CSS">
@supports (align-content: center) &#123;
  .container &#123;
    align-content: center;
  &#125;
&#125;
@supports not (align-content: center) &#123;
  &#x2F;* 當樣式不被瀏覽器所支援就套用此處的樣式 *&#x2F;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3></li>
</ol>
<p>以下是所有垂直置中方法</p>
<pre class="line-numbers language-css" data-language="css"><code class="language-css">&lt;p>Various methods for vertical centering. Yellow is container and green is content wrapper. Note that the first and last methods do not require a content wrapper.&lt;/p>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"display: table;"</span>>
  &lt;div style=<span class="token string">"display: table-cell; vertical-align: middle;"</span>>
    Table cell with &lt;code>vertical-align&lt;/code>.
  &lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"position: relative;"</span>>
  &lt;div class=<span class="token string">"content"</span> style=<span class="token string">"position: absolute; top: 50%; transform: translateY(-50%);"</span>>
    &lt;b>Absolute&lt;/b> positioning.
  &lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span>>
  &lt;span style=<span class="token string">"display: inline-block; vertical-align: middle; height: 100%;"</span>>&lt;/span>&lt;div class=<span class="token string">"content"</span> style=<span class="token string">"display: inline-block; vertical-align: middle;"</span>>
    &lt;b>Inline&lt;/b> content.
  &lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"display: flex; align-items: center;"</span>>
  &lt;div class=<span class="token string">"content"</span>>Single-line &lt;b>flexbox&lt;/b> <span class="token punctuation">(</span>cross axis<span class="token punctuation">)</span>.&lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"display: flex; flex-flow: column; justify-content: center;"</span>>
  &lt;div class=<span class="token string">"content"</span>>Single-line &lt;b>flexbox&lt;/b> <span class="token punctuation">(</span>main axis<span class="token punctuation">)</span>.&lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"display: flex; flex-flow: row wrap; align-content: center;"</span>>
  &lt;div class=<span class="token string">"content"</span>>Multi-line &lt;b>flexbox&lt;/b> <span class="token punctuation">(</span>cross axis<span class="token punctuation">)</span>.&lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"display: grid; align-content: center;"</span>>
  &lt;div class=<span class="token string">"content"</span>>&lt;b>Grid&lt;/b> content.&lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"display: grid; align-items: center;"</span>>
  &lt;div class=<span class="token string">"content"</span>>&lt;b>Grid&lt;/b> cell.&lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"display: grid;"</span>>
  &lt;div class=<span class="token string">"content"</span> style=<span class="token string">"margin-block: auto;"</span>>
    Auto-&lt;b>margin&lt;/b>.
  &lt;/div>
&lt;/div>

&lt;div class=<span class="token string">"container"</span> style=<span class="token string">"align-content: center;"</span>>
  &lt;code>align-content&lt;/code> just works in 2024!
&lt;/div>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="實現二維對齊"><a href="#實現二維對齊" class="headerlink" title="實現二維對齊"></a>實現二維對齊</h2><p>有沒有一個<em>水平</em>對齊的<strong>單一屬性</strong>?<code>align-content</code>的對應屬性是什麼?讓我們看看各種對齊屬性:</p>
<table>
<thead>
<tr>
<th></th>
<th>flow</th>
<th>flexbox</th>
<th>grid</th>
</tr>
</thead>
<tbody><tr>
<td><code>  align-content</code></td>
<td>block軸</td>
<td>交叉軸(行)</td>
<td>block軸(網格)</td>
</tr>
<tr>
<td><code>justify-content</code></td>
<td>無效果</td>
<td>主軸</td>
<td>inline軸(網格)</td>
</tr>
<tr>
<td><code>  align-items</code></td>
<td>無效果</td>
<td>交叉軸(項目)</td>
<td>block軸(單元格)</td>
</tr>
<tr>
<td><code>justify-items</code></td>
<td>無效果</td>
<td>無效果</td>
<td>inline軸(單元格)</td>
</tr>
</tbody></table>
<p>表:不同佈局中的對齊屬性</p>
<h3 id="背景-CSS軸術語"><a href="#背景-CSS軸術語" class="headerlink" title="背景:CSS軸術語"></a>背景:CSS軸術語</h3><p><em>block軸</em>通常是<em>垂直的</em>，<em>inline軸</em>是<em>水平的</em>。需要這些術語是因為<a target="_blank" rel="noopener" href="https://build-your-own.org/visual_css/2p40_box_model.html#:~:text=Logical%20properties">垂直<code>writing-mode</code></a>是存在的,所以<strong>block軸和inline軸是相對於文字方向的</strong>。這類似於<em>主軸</em>和<em>交叉軸</em>是相對於flexbox項目方向的。</p>
<p><strong>結論</strong>: “items”用於可以<em>單獨</em>對齊的內容。在主軸上,flex項目不能單獨對齊,所以是”content”。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/08/22/cm82sqlem0009a49713i77moc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/22/cm82sqlem0009a49713i77moc/" class="post-title-link" itemprop="url">Docker 容器化進階：自動化部署與 CI/CD 實戰指南</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-08-22 18:33:25" itemprop="dateCreated datePublished" datetime="2024-08-22T18:33:25+08:00">2024-08-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:47:08" itemprop="dateModified" datetime="2024-11-27T14:47:08+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%96%8B%E7%99%BC%E7%9B%B8%E9%97%9C/" itemprop="url" rel="index"><span itemprop="name">開發相關</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Docker-容器化進階：自動化部署與-CI-CD-實戰指南"><a href="#Docker-容器化進階：自動化部署與-CI-CD-實戰指南" class="headerlink" title="Docker 容器化進階：自動化部署與 CI/CD 實戰指南"></a>Docker 容器化進階：自動化部署與 CI/CD 實戰指南</h1><p>本文承接<a href="https://kyosora.github.io/2024/08/20/%E5%BE%9E%E9%9B%B6%E9%96%8B%E5%A7%8B%E7%9A%84-Docker-%E5%AE%B9%E5%99%A8%E5%8C%96%E6%8C%87%E5%8D%97-Vue3-+-.NET-Core-+-SQL-Server/">從零開始的 Docker 容器化指南</a>，主要討論如何實現全自動化的 Docker 部署流程。透過整合 GitHub Actions、Docker Hub 和自動化工具，我們可以實現程式碼推送後自動更新生產環境的目標。</p>
<h2 id="目錄"><a href="#目錄" class="headerlink" title="目錄"></a>目錄</h2><ul>
<li><a href="#%E8%87%AA%E5%8B%95%E5%8C%96%E9%83%A8%E7%BD%B2%E6%A6%82%E8%BF%B0">自動化部署概述</a></li>
<li><a href="#github-actions-%E8%A8%AD%E5%AE%9A">GitHub Actions 設定</a></li>
<li><a href="#%E8%87%AA%E5%8B%95%E6%9B%B4%E6%96%B0%E5%AE%B9%E5%99%A8%E8%A8%AD%E5%AE%9A">自動更新容器設定</a></li>
<li><a href="#%E9%9B%B6%E5%81%9C%E6%A9%9F%E9%83%A8%E7%BD%B2%E7%AD%96%E7%95%A5">零停機部署策略</a></li>
<li><a href="#%E5%82%99%E4%BB%BD%E8%88%87%E9%82%84%E5%8E%9F%E6%A9%9F%E5%88%B6">備份與還原機制</a></li>
<li><a href="#%E7%9B%A3%E6%8E%A7%E8%88%87%E5%91%8A%E8%AD%A6%E8%A8%AD%E5%AE%9A">監控與告警設定</a></li>
<li><a href="#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4%E8%88%87%E5%9B%9E%E6%BB%BE%E6%B5%81%E7%A8%8B">故障排除與回滾流程</a></li>
<li><a href="#%E6%9C%80%E4%BD%B3%E5%AF%A6%E8%B8%90%E5%BB%BA%E8%AD%B0">最佳實踐建議</a></li>
</ul>
<h2 id="自動化部署概述"><a href="#自動化部署概述" class="headerlink" title="自動化部署概述"></a>自動化部署概述</h2><p>完整的自動化部署流程包含以下步驟：</p>
<ol>
<li>開發者推送程式碼到 GitHub</li>
<li>GitHub Actions 自動執行測試和建置</li>
<li>建立新的 Docker 映像檔並推送至 Docker Hub</li>
<li>生產環境自動偵測並更新容器</li>
<li>健康檢查確認部署狀態</li>
</ol>
<h3 id="部署流程圖"><a href="#部署流程圖" class="headerlink" title="部署流程圖"></a>部署流程圖</h3><pre class="line-numbers language-mermaid" data-language="mermaid"><code class="language-mermaid"><span class="token keyword">graph</span> TD
    A<span class="token text string">[開發者推送程式碼]</span> <span class="token arrow operator">--></span> B<span class="token text string">[GitHub Actions 觸發]</span>
    B <span class="token arrow operator">--></span> C<span class="token text string">[執行測試]</span>
    C <span class="token arrow operator">--></span> D<span class="token text string">[建立 Docker 映像檔]</span>
    D <span class="token arrow operator">--></span> E<span class="token text string">[推送至 Docker Hub]</span>
    E <span class="token arrow operator">--></span> F<span class="token text string">[生產環境更新]</span>
    F <span class="token arrow operator">--></span> G<span class="token text string">[健康檢查]</span>
    G <span class="token arrow operator">--></span><span class="token label property">|成功|</span> H<span class="token text string">[部署完成]</span>
    G <span class="token arrow operator">--></span><span class="token label property">|失敗|</span> I<span class="token text string">[自動回滾]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="GitHub-Actions-設定"><a href="#GitHub-Actions-設定" class="headerlink" title="GitHub Actions 設定"></a>GitHub Actions 設定</h2><h3 id="1-基礎設定"><a href="#1-基礎設定" class="headerlink" title="1. 基礎設定"></a>1. 基礎設定</h3><p>建立 <code>.github/workflows/deploy.yml</code> 檔案：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy to Production

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> main <span class="token punctuation">]</span>
  <span class="token key atrule">workflow_dispatch</span><span class="token punctuation">:</span>  <span class="token comment"># 允許手動觸發</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout code
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up Docker Buildx
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/setup<span class="token punctuation">-</span>buildx<span class="token punctuation">-</span>action@v1

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Cache Docker layers
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> /tmp/.buildx<span class="token punctuation">-</span>cache
          <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> runner.os <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">-</span>buildx<span class="token punctuation">-</span>$<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> github.sha <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
          <span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            $&#123;&#123; runner.os &#125;&#125;-buildx-</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Login to Docker Hub
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/login<span class="token punctuation">-</span>action@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">username</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.DOCKER_HUB_USERNAME <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
          <span class="token key atrule">password</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.DOCKER_HUB_ACCESS_TOKEN <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build and push
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/build<span class="token punctuation">-</span>push<span class="token punctuation">-</span>action@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">context</span><span class="token punctuation">:</span> .
          <span class="token key atrule">push</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">tags</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            user/myapp:latest
            user/myapp:$&#123;&#123; github.sha &#125;&#125;</span>
          <span class="token key atrule">cache-from</span><span class="token punctuation">:</span> type=local<span class="token punctuation">,</span>src=/tmp/.buildx<span class="token punctuation">-</span>cache
          <span class="token key atrule">cache-to</span><span class="token punctuation">:</span> type=local<span class="token punctuation">,</span>dest=/tmp/.buildx<span class="token punctuation">-</span>cache<span class="token punctuation">-</span>new

      <span class="token comment"># 更新快取</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Move cache
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          rm -rf /tmp/.buildx-cache
          mv /tmp/.buildx-cache-new /tmp/.buildx-cache</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-部署到伺服器"><a href="#2-部署到伺服器" class="headerlink" title="2. 部署到伺服器"></a>2. 部署到伺服器</h3><p>添加遠端部署步驟：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy to Production
  <span class="token key atrule">uses</span><span class="token punctuation">:</span> appleboy/ssh<span class="token punctuation">-</span>action@master
  <span class="token key atrule">with</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.SERVER_HOST <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.SERVER_USER <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.SERVER_SSH_KEY <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token key atrule">script</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
      cd /path/to/project
      ./deploy.sh $&#123;&#123; github.sha &#125;&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="自動更新容器設定"><a href="#自動更新容器設定" class="headerlink" title="自動更新容器設定"></a>自動更新容器設定</h2><h3 id="1-Watchtower-設定"><a href="#1-Watchtower-設定" class="headerlink" title="1. Watchtower 設定"></a>1. Watchtower 設定</h3><p>Watchtower 可以自動監測和更新 Docker 容器：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># docker-compose.yml</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">watchtower</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> containrrr/watchtower
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /var/run/docker.sock<span class="token punctuation">:</span>/var/run/docker.sock
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> WATCHTOWER_CLEANUP=true
      <span class="token punctuation">-</span> WATCHTOWER_LABEL_ENABLE=true
      <span class="token punctuation">-</span> WATCHTOWER_NOTIFICATION_URL=slack<span class="token punctuation">:</span>//hook<span class="token punctuation">-</span>url
    <span class="token key atrule">labels</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"com.centurylinklabs.watchtower.enable=true"</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>interval 300 <span class="token comment"># 每5分鐘檢查一次</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-容器標籤設定"><a href="#2-容器標籤設定" class="headerlink" title="2. 容器標籤設定"></a>2. 容器標籤設定</h3><p>為需要自動更新的服務加上標籤：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">labels</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"com.centurylinklabs.watchtower.enable=true"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="零停機部署策略"><a href="#零停機部署策略" class="headerlink" title="零停機部署策略"></a>零停機部署策略</h2><h3 id="1-藍綠部署"><a href="#1-藍綠部署" class="headerlink" title="1. 藍綠部署"></a>1. 藍綠部署</h3><p>建立部署腳本 <code>deploy.sh</code>：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># 設定變數</span>
<span class="token assign-left variable">APP_NAME</span><span class="token operator">=</span><span class="token string">"myapp"</span>
<span class="token assign-left variable">BLUE_PORT</span><span class="token operator">=</span><span class="token string">"8080"</span>
<span class="token assign-left variable">GREEN_PORT</span><span class="token operator">=</span><span class="token string">"8081"</span>
<span class="token assign-left variable">PROXY_PORT</span><span class="token operator">=</span><span class="token string">"80"</span>
<span class="token assign-left variable">VERSION</span><span class="token operator">=</span><span class="token variable">$1</span>

<span class="token comment"># 獲取當前活動的部署顏色</span>
<span class="token assign-left variable">ACTIVE_COLOR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">--filter</span> <span class="token string">"name=<span class="token variable">$&#123;APP_NAME&#125;</span>-"</span> <span class="token parameter variable">--format</span> <span class="token string">"&#123;&#123;.Names&#125;&#125;"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-o</span> <span class="token string">'blue\|green'</span><span class="token variable">)</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$ACTIVE_COLOR</span>"</span> <span class="token operator">==</span> <span class="token string">"blue"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">NEW_COLOR</span><span class="token operator">=</span><span class="token string">"green"</span>
    <span class="token assign-left variable">NEW_PORT</span><span class="token operator">=</span><span class="token variable">$GREEN_PORT</span>
<span class="token keyword">else</span>
    <span class="token assign-left variable">NEW_COLOR</span><span class="token operator">=</span><span class="token string">"blue"</span>
    <span class="token assign-left variable">NEW_PORT</span><span class="token operator">=</span><span class="token variable">$BLUE_PORT</span>
<span class="token keyword">fi</span>

<span class="token builtin class-name">echo</span> <span class="token string">"Starting <span class="token variable">$NEW_COLOR</span> deployment..."</span>

<span class="token comment"># 部署新版本</span>
<span class="token function">docker-compose</span> <span class="token parameter variable">-f</span> docker-compose.<span class="token variable">$NEW_COLOR</span>.yml up <span class="token parameter variable">-d</span> <span class="token parameter variable">--build</span>

<span class="token comment"># 等待服務啟動</span>
<span class="token function">sleep</span> <span class="token number">10</span>

<span class="token comment"># 健康檢查</span>
<span class="token keyword">if</span> <span class="token function">curl</span> <span class="token parameter variable">-f</span> <span class="token string">"http://localhost:<span class="token variable">$NEW_PORT</span>/health"</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token comment"># 切換流量</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Switching traffic to <span class="token variable">$NEW_COLOR</span> deployment"</span>
    <span class="token function">docker-compose</span> <span class="token parameter variable">-f</span> docker-compose.proxy.yml up <span class="token parameter variable">-d</span> --force-recreate
    
    <span class="token comment"># 移除舊版本</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">"<span class="token variable">$ACTIVE_COLOR</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">docker-compose</span> <span class="token parameter variable">-f</span> docker-compose.<span class="token variable">$ACTIVE_COLOR</span>.yml down
    <span class="token keyword">fi</span>
    
    <span class="token builtin class-name">echo</span> <span class="token string">"Deployment successful!"</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Health check failed! Rolling back..."</span>
    <span class="token function">docker-compose</span> <span class="token parameter variable">-f</span> docker-compose.<span class="token variable">$NEW_COLOR</span>.yml down
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-健康檢查設定"><a href="#2-健康檢查設定" class="headerlink" title="2. 健康檢查設定"></a>2. 健康檢查設定</h3><p>在服務中設定健康檢查：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">healthcheck</span><span class="token punctuation">:</span>
      <span class="token key atrule">test</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"CMD"</span><span class="token punctuation">,</span> <span class="token string">"curl"</span><span class="token punctuation">,</span> <span class="token string">"-f"</span><span class="token punctuation">,</span> <span class="token string">"http://localhost/health"</span><span class="token punctuation">]</span>
      <span class="token key atrule">interval</span><span class="token punctuation">:</span> 30s
      <span class="token key atrule">timeout</span><span class="token punctuation">:</span> 10s
      <span class="token key atrule">retries</span><span class="token punctuation">:</span> <span class="token number">3</span>
      <span class="token key atrule">start_period</span><span class="token punctuation">:</span> 40s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="備份與還原機制"><a href="#備份與還原機制" class="headerlink" title="備份與還原機制"></a>備份與還原機制</h2><h3 id="1-自動備份設定"><a href="#1-自動備份設定" class="headerlink" title="1. 自動備份設定"></a>1. 自動備份設定</h3><p>建立備份腳本 <code>backup.sh</code>：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># 設定變數</span>
<span class="token assign-left variable">BACKUP_DIR</span><span class="token operator">=</span><span class="token string">"/backups"</span>
<span class="token assign-left variable">TIMESTAMP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y%m%d_%H%M%S<span class="token variable">)</span></span>

<span class="token comment"># 建立備份目錄</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$BACKUP_DIR</span>

<span class="token comment"># 備份 Docker Compose 設定</span>
<span class="token function">docker-compose</span> config <span class="token operator">></span> <span class="token variable">$BACKUP_DIR</span>/docker-compose-<span class="token variable">$TIMESTAMP</span>.yml

<span class="token comment"># 備份容器資料</span>
<span class="token function">docker-compose</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-T</span> db <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">'mysqldump -u root -p"$MYSQL_ROOT_PASSWORD" --all-databases'</span> <span class="token operator">></span> <span class="token variable">$BACKUP_DIR</span>/db-<span class="token variable">$TIMESTAMP</span>.sql

<span class="token comment"># 保留最近 7 天的備份</span>
<span class="token function">find</span> <span class="token variable">$BACKUP_DIR</span> <span class="token parameter variable">-type</span> f <span class="token parameter variable">-mtime</span> +7 <span class="token parameter variable">-delete</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-還原流程"><a href="#2-還原流程" class="headerlink" title="2. 還原流程"></a>2. 還原流程</h3><p>建立還原腳本 <code>restore.sh</code>：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Please provide backup timestamp"</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">TIMESTAMP</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token assign-left variable">BACKUP_DIR</span><span class="token operator">=</span><span class="token string">"/backups"</span>

<span class="token comment"># 檢查備份檔案是否存在</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$BACKUP_DIR</span>/docker-compose-<span class="token variable">$TIMESTAMP</span>.yml"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> 
   <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$BACKUP_DIR</span>/db-<span class="token variable">$TIMESTAMP</span>.sql"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Backup files not found"</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>

<span class="token comment"># 停止現有服務</span>
<span class="token function">docker-compose</span> down

<span class="token comment"># 還原設定檔</span>
<span class="token function">cp</span> <span class="token variable">$BACKUP_DIR</span>/docker-compose-<span class="token variable">$TIMESTAMP</span>.yml docker-compose.yml

<span class="token comment"># 啟動服務</span>
<span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>

<span class="token comment"># 還原資料庫</span>
<span class="token function">docker-compose</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-T</span> db <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">"mysql -u root -p<span class="token entity" title="\&quot;">\"</span><span class="token variable">$MYSQL_ROOT_PASSWORD</span><span class="token entity" title="\&quot;">\"</span>"</span> <span class="token operator">&lt;</span> <span class="token variable">$BACKUP_DIR</span>/db-<span class="token variable">$TIMESTAMP</span>.sql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="監控與告警設定"><a href="#監控與告警設定" class="headerlink" title="監控與告警設定"></a>監控與告警設定</h2><h3 id="1-Prometheus-設定"><a href="#1-Prometheus-設定" class="headerlink" title="1. Prometheus 設定"></a>1. Prometheus 設定</h3><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># docker-compose.yml</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">prometheus</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> prom/prometheus
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./prometheus.yml<span class="token punctuation">:</span>/etc/prometheus/prometheus.yml
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"9090:9090"</span>

  <span class="token key atrule">grafana</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> grafana/grafana
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"3000:3000"</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> prometheus<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-告警設定"><a href="#2-告警設定" class="headerlink" title="2. 告警設定"></a>2. 告警設定</h3><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># prometheus.yml</span>
<span class="token key atrule">alerting</span><span class="token punctuation">:</span>
  <span class="token key atrule">alertmanagers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> alertmanager<span class="token punctuation">:</span><span class="token number">9093</span>

<span class="token key atrule">rule_files</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> alert.rules.yml

<span class="token key atrule">scrape_configs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">'docker'</span>
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'localhost:9323'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="故障排除與回滾流程"><a href="#故障排除與回滾流程" class="headerlink" title="故障排除與回滾流程"></a>故障排除與回滾流程</h2><h3 id="1-常見問題處理"><a href="#1-常見問題處理" class="headerlink" title="1. 常見問題處理"></a>1. 常見問題處理</h3><ul>
<li>映像檔拉取失敗</li>
<li>容器啟動失敗</li>
<li>健康檢查失敗</li>
<li>資料庫連線問題</li>
</ul>
<h3 id="2-回滾流程"><a href="#2-回滾流程" class="headerlink" title="2. 回滾流程"></a>2. 回滾流程</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># rollback.sh</span>

<span class="token assign-left variable">VERSION</span><span class="token operator">=</span><span class="token variable">$1</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$VERSION</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Please specify version to rollback"</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>

<span class="token comment"># 拉取指定版本映像檔</span>
<span class="token function">docker-compose</span> pull

<span class="token comment"># 設定版本</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">APP_VERSION</span><span class="token operator">=</span><span class="token variable">$VERSION</span>

<span class="token comment"># 停止並重新啟動服務</span>
<span class="token function">docker-compose</span> down
<span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="最佳實踐建議"><a href="#最佳實踐建議" class="headerlink" title="最佳實踐建議"></a>最佳實踐建議</h2><ol>
<li><p>版本管理</p>
<ul>
<li>使用語意化版本號</li>
<li>保留歷史版本映像檔</li>
<li>定期清理舊版本</li>
</ul>
</li>
<li><p>監控策略</p>
<ul>
<li>設定關鍵指標監控</li>
<li>建立適當的告警閾值</li>
<li>保留足夠的日誌資訊</li>
</ul>
</li>
<li><p>部署安全</p>
<ul>
<li>使用加密的環境變數</li>
<li>實施適當的存取控制</li>
<li>定期更新基礎映像檔</li>
</ul>
</li>
<li><p>效能優化</p>
<ul>
<li>最佳化映像檔大小</li>
<li>使用多階段建置</li>
<li>實施快取策略</li>
</ul>
</li>
</ol>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>透過本文介紹的自動化部署流程，我們可以大幅減少人工操作，提高部署效率和可靠性。記得根據實際需求調整配置，並持續優化部署流程。</p>
<h2 id="參考資源"><a href="#參考資源" class="headerlink" title="參考資源"></a>參考資源</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.github.com/en/actions">GitHub Actions 文件</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/compose/">Docker Compose 文件</a></li>
<li><a target="_blank" rel="noopener" href="https://containrrr.dev/watchtower/">Watchtower 文件</a></li>
<li><a target="_blank" rel="noopener" href="https://prometheus.io/docs/introduction/overview/">Prometheus 文件</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/08/22/cm82sqlhx0078a4978zhnek2j/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/22/cm82sqlhx0078a4978zhnek2j/" class="post-title-link" itemprop="url">效能狂飆100倍！認識Python精神繼承者Mojo程式語言</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-08-22 18:16:06" itemprop="dateCreated datePublished" datetime="2024-08-22T18:16:06+08:00">2024-08-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 16:22:14" itemprop="dateModified" datetime="2024-11-27T16:22:14+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/" itemprop="url" rel="index"><span itemprop="name">程式設計</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="什麼是Mojo程式語言"><a href="#什麼是Mojo程式語言" class="headerlink" title="什麼是Mojo程式語言?"></a>什麼是Mojo程式語言?</h1><p>想像一個程式語言,它繼承了Python的簡潔易用,卻能提供與C++相媲美的極致效能,這就是Mojo程式語言。由Swift語言創始者Chris Lattner領軍開發的Mojo,被視為Python的超集合(superset),為AI和高效能運算開啟了新篇章。</p>
<h2 id="為什麼我們需要Mojo"><a href="#為什麼我們需要Mojo" class="headerlink" title="為什麼我們需要Mojo?"></a>為什麼我們需要Mojo?</h2><p>Python雖然是全球最受歡迎的程式語言之一,但在效能方面一直為人所詬病。特別是在AI和機器學習領域,Python的執行速度常常成為效能瓶頸。Mojo就是為了解決這個問題而生,它讓開發者能夠:</p>
<ul>
<li>使用熟悉的Python語法</li>
<li>獲得接近原生程式碼的執行效能</li>
<li>無需重寫既有的Python程式碼</li>
<li>擁有更好的記憶體管理機制</li>
</ul>
<svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
    <!-- 背景 -->
    <rect width="800" height="400" fill="#f8f9fa"></rect>
    <!-- 標題 -->
    <text x="400" y="50" text-anchor="middle" font-size="24" fill="#333">Python vs Mojo 效能比較</text>
    <!-- Y軸 -->
    <line x1="100" y1="350" x2="100" y2="100" stroke="#333" stroke-width="2"></line>
    <text x="90" y="225" text-anchor="end" font-size="14" fill="#666" transform="rotate(-90, 90, 225)">執行時間 (毫秒)</text>
    <!-- X軸 -->
    <line x1="100" y1="350" x2="700" y2="350" stroke="#333" stroke-width="2"></line>
    <!-- 長條圖 - Python -->
    <rect x="200" y="150" width="100" height="200" fill="#3776ab" opacity="0.8"></rect>
    <text x="250" y="370" text-anchor="middle" font-size="14" fill="#333">Python</text>
    <text x="250" y="140" text-anchor="middle" font-size="14" fill="#333">100ms</text>
    <!-- 長條圖 - Mojo -->
    <rect x="500" y="330" width="100" height="20" fill="#ff6b6b" opacity="0.8"></rect>
    <text x="550" y="370" text-anchor="middle" font-size="14" fill="#333">Mojo</text>
    <text x="550" y="320" text-anchor="middle" font-size="14" fill="#333">1ms</text>
    <!-- 圖例 -->
    <rect x="350" y="60" width="15" height="15" fill="#3776ab" opacity="0.8"></rect>
    <text x="370" y="72" font-size="12" fill="#333">Python</text>
    <rect x="450" y="60" width="15" height="15" fill="#ff6b6b" opacity="0.8"></rect>
    <text x="470" y="72" font-size="12" fill="#333">Mojo</text>
</svg>

<h2 id="Mojo的關鍵特色"><a href="#Mojo的關鍵特色" class="headerlink" title="Mojo的關鍵特色"></a>Mojo的關鍵特色</h2><h3 id="1-Python相容性"><a href="#1-Python相容性" class="headerlink" title="1. Python相容性"></a>1. Python相容性</h3><p>Mojo完全相容Python語法,讓Python開發者可以無痛上手:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Python程式碼</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token comment"># Mojo程式碼 - 語法完全相同</span>
fn add<span class="token punctuation">(</span>x<span class="token punctuation">:</span> Int<span class="token punctuation">,</span> y<span class="token punctuation">:</span> Int<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Int<span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-強大的效能優化"><a href="#2-強大的效能優化" class="headerlink" title="2. 強大的效能優化"></a>2. 強大的效能優化</h3><p>Mojo引入了系統程式語言級別的效能優化機制:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Mojo的SIMD向量運算最佳化</span>
fn vector_add<span class="token punctuation">(</span>x<span class="token punctuation">:</span> SIMD<span class="token punctuation">[</span>DType<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> SIMD<span class="token punctuation">[</span>DType<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> SIMD<span class="token punctuation">[</span>DType<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="3-記憶體安全"><a href="#3-記憶體安全" class="headerlink" title="3. 記憶體安全"></a>3. 記憶體安全</h3><p>Mojo提供了先進的記憶體管理機制:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Mojo的所有權系統確保記憶體安全</span>
fn process_data<span class="token punctuation">(</span><span class="token punctuation">)</span> raises<span class="token punctuation">:</span>
    let data <span class="token operator">=</span> Array<span class="token punctuation">[</span>Int<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>  <span class="token comment"># 自動管理記憶體生命週期</span>
    <span class="token comment"># 處理資料...</span>
    <span class="token keyword">return</span>  <span class="token comment"># 離開函式時自動釋放記憶體</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-平行運算支援"><a href="#4-平行運算支援" class="headerlink" title="4. 平行運算支援"></a>4. 平行運算支援</h3><p>內建的平行運算功能讓多核心處理變得簡單:</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Mojo的平行運算支援</span>
fn parallel_sum<span class="token punctuation">(</span>data<span class="token punctuation">:</span> Array<span class="token punctuation">[</span>Int<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Int<span class="token punctuation">:</span>
    var result <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token decorator annotation punctuation">@parallel</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        result <span class="token operator">+=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">return</span> result<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="實際應用案例"><a href="#實際應用案例" class="headerlink" title="實際應用案例"></a>實際應用案例</h2><p>Mojo特別適合以下場景:</p>
<ol>
<li>機器學習模型訓練</li>
<li>科學運算</li>
<li>高效能運算</li>
<li>系統程式開發</li>
<li>遊戲引擎開發</li>
</ol>
<h2 id="未來展望"><a href="#未來展望" class="headerlink" title="未來展望"></a>未來展望</h2><p>Mojo仍在積極發展中,未來將會:</p>
<ul>
<li>擴充標準函式庫</li>
<li>提供更多最佳化工具</li>
<li>改善開發者體驗</li>
<li>強化與現有Python生態系統的整合</li>
</ul>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>Mojo為Python開發者帶來了革命性的改變。它不僅保留了Python的優雅語法,還提供了系統級程式語言的效能。無論是AI開發、科學運算還是一般應用程式開發,Mojo都值得一試。</p>
<h2 id="參考資源"><a href="#參考資源" class="headerlink" title="參考資源"></a>參考資源</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.modular.com/mojo">Mojo程式語言官方網站</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/modularml/mojo">Mojo GitHub Repository</a></li>
<li><a target="_blank" rel="noopener" href="https://www.modular.com/blog/mojo-its-finally-here">Chris Lattner的Mojo介紹文章</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://kyosora.github.io/2024/08/20/cm82sqlhr0071a497e839ch1u/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kyosora">
      <meta itemprop="description" content="個人技術筆記和學習心得分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kyosora 虛空筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/20/cm82sqlhr0071a497e839ch1u/" class="post-title-link" itemprop="url">從零開始的 Docker 容器化指南: Vue3 + .NET Core + SQL Server</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2024-08-20 18:11:01" itemprop="dateCreated datePublished" datetime="2024-08-20T18:11:01+08:00">2024-08-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-11-27 14:51:00" itemprop="dateModified" datetime="2024-11-27T14:51:00+08:00">2024-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A8%8B%E5%BC%8F%E6%95%99%E5%AD%B8/" itemprop="url" rel="index"><span itemprop="name">程式教學</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="從零開始的-Docker-容器化指南-Vue3-NET-Core-SQL-Server"><a href="#從零開始的-Docker-容器化指南-Vue3-NET-Core-SQL-Server" class="headerlink" title="從零開始的 Docker 容器化指南: Vue3 + .NET Core + SQL Server"></a>從零開始的 Docker 容器化指南: Vue3 + .NET Core + SQL Server</h1><h2 id="目錄"><a href="#目錄" class="headerlink" title="目錄"></a>目錄</h2><ul>
<li><a href="#docker-%E5%9F%BA%E7%A4%8E%E6%A6%82%E5%BF%B5">Docker 基礎概念</a></li>
<li><a href="#%E7%92%B0%E5%A2%83%E6%BA%96%E5%82%99">環境準備</a></li>
<li><a href="#sql-server-%E5%AE%B9%E5%99%A8%E8%A8%AD%E5%AE%9A">SQL Server 容器設定</a></li>
<li><a href="#net-core-api-%E5%AE%B9%E5%99%A8%E5%8C%96">.NET Core API 容器化</a></li>
<li><a href="#vue3-%E5%89%8D%E7%AB%AF%E5%AE%B9%E5%99%A8%E5%8C%96">Vue3 前端容器化</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8-docker-compose-%E6%95%B4%E5%90%88%E6%9C%8D%E5%8B%99">使用 Docker Compose 整合服務</a></li>
<li><a href="#%E8%B3%87%E6%BA%90%E7%AE%A1%E7%90%86%E8%88%87%E7%9B%A3%E6%8E%A7">資源管理與監控</a></li>
<li><a href="#%E9%96%8B%E7%99%BC%E7%92%B0%E5%A2%83%E8%A8%AD%E5%AE%9A">開發環境設定</a></li>
<li><a href="#%E7%B6%B2%E8%B7%AF%E9%85%8D%E7%BD%AE">網路配置</a></li>
<li><a href="#%E9%83%A8%E7%BD%B2%E8%88%87%E7%B6%AD%E8%AD%B7">部署與維護</a></li>
<li><a href="#%E5%B8%B8%E8%A6%8B%E5%95%8F%E9%A1%8C%E8%88%87%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88">常見問題與解決方案</a></li>
</ul>
<h2 id="Docker-基礎概念"><a href="#Docker-基礎概念" class="headerlink" title="Docker 基礎概念"></a>Docker 基礎概念</h2><p>Docker 是一個開放原始碼的容器化平台，它可以讓我們將應用程式和其依賴項打包成一個獨立的容器。容器就像是一個輕量級的虛擬機，可以在任何支援 Docker 的環境中運行。</p>
<p>主要優點：</p>
<ul>
<li>環境一致性</li>
<li>快速部署</li>
<li>資源效率</li>
<li>易於擴展</li>
</ul>
<h2 id="環境準備"><a href="#環境準備" class="headerlink" title="環境準備"></a>環境準備</h2><ol>
<li><p>安裝 Docker Desktop</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Windows/Mac 下載並安裝 Docker Desktop</span>
https://www.docker.com/products/docker-desktop/

<span class="token comment"># Linux (Ubuntu) 安裝 Docker Engine</span>
<span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> docker.io
<span class="token function">sudo</span> systemctl start <span class="token function">docker</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>確認安裝</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token parameter variable">--version</span>
<span class="token function">docker-compose</span> <span class="token parameter variable">--version</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="SQL-Server-容器設定"><a href="#SQL-Server-容器設定" class="headerlink" title="SQL Server 容器設定"></a>SQL Server 容器設定</h2><ol>
<li><p>建立 SQL Server 容器</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull mcr.microsoft.com/mssql/server:2019-latest

<span class="token function">docker</span> run <span class="token parameter variable">-e</span> <span class="token string">"ACCEPT_EULA=Y"</span> <span class="token parameter variable">-e</span> <span class="token string">"SA_PASSWORD=YourStrong@Passw0rd"</span> <span class="token punctuation">\</span>
   <span class="token parameter variable">-p</span> <span class="token number">1433</span>:1433 <span class="token parameter variable">--name</span> sqlserver <span class="token punctuation">\</span>
   <span class="token parameter variable">-v</span> sqlvolume:/var/opt/mssql <span class="token punctuation">\</span>
   <span class="token parameter variable">-d</span> mcr.microsoft.com/mssql/server:2019-latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>確認容器運行狀態</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">ps</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<h2 id="NET-Core-API-容器化"><a href="#NET-Core-API-容器化" class="headerlink" title=".NET Core API 容器化"></a>.NET Core API 容器化</h2><ol>
<li><p>在專案根目錄建立 Dockerfile</p>
<pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> mcr.microsoft.com/dotnet/sdk:6.0 <span class="token keyword">AS</span> build</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /src</span>
<span class="token instruction"><span class="token keyword">COPY</span> [<span class="token string">"YourProject.csproj"</span>, <span class="token string">"./"</span>]</span>
<span class="token instruction"><span class="token keyword">RUN</span> dotnet restore</span>
<span class="token instruction"><span class="token keyword">COPY</span> . .</span>
<span class="token instruction"><span class="token keyword">RUN</span> dotnet build -c Release -o /app/build</span>

<span class="token instruction"><span class="token keyword">FROM</span> mcr.microsoft.com/dotnet/aspnet:6.0</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">build</span></span> /app/build .</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"dotnet"</span>, <span class="token string">"YourProject.dll"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>設定 .dockerignore</p>
<pre class="line-numbers language-none"><code class="language-none">bin&#x2F;
obj&#x2F;
node_modules&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
<li><p>建立映像檔和容器</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> myapi <span class="token builtin class-name">.</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">5000</span>:80 <span class="token parameter variable">--name</span> api myapi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="Vue3-前端容器化"><a href="#Vue3-前端容器化" class="headerlink" title="Vue3 前端容器化"></a>Vue3 前端容器化</h2><ol>
<li><p>建立 Dockerfile</p>
<pre class="line-numbers language-docker" data-language="docker"><code class="language-docker"><span class="token instruction"><span class="token keyword">FROM</span> node:16 <span class="token keyword">as</span> build-stage</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">COPY</span> package*.json ./</span>
<span class="token instruction"><span class="token keyword">RUN</span> npm install</span>
<span class="token instruction"><span class="token keyword">COPY</span> . .</span>
<span class="token instruction"><span class="token keyword">RUN</span> npm run build</span>

<span class="token instruction"><span class="token keyword">FROM</span> nginx:stable-alpine <span class="token keyword">as</span> production-stage</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">build-stage</span></span> /app/dist /usr/share/nginx/html</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 80</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">"nginx"</span>, <span class="token string">"-g"</span>, <span class="token string">"daemon off;"</span>]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>建立映像檔和容器</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> myvue <span class="token builtin class-name">.</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span>:80 <span class="token parameter variable">--name</span> frontend myvue<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ol>
<h2 id="使用-Docker-Compose-整合服務"><a href="#使用-Docker-Compose-整合服務" class="headerlink" title="使用 Docker Compose 整合服務"></a>使用 Docker Compose 整合服務</h2><ol>
<li><p>建立 docker-compose.yml</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.8'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mcr.microsoft.com/mssql/server<span class="token punctuation">:</span>2019<span class="token punctuation">-</span>latest
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ACCEPT_EULA=Y
      <span class="token punctuation">-</span> SA_PASSWORD=YourStrong@Passw0rd
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"1433:1433"</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> sqlvolume<span class="token punctuation">:</span>/var/opt/mssql

  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./api
      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"5000:80"</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ConnectionStrings__DefaultConnection=Server=db;Database=YourDB;User=sa;Password=YourStrong@Passw0rd;

  <span class="token key atrule">frontend</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./frontend
      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8080:80"</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> api

<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  sqlvolume<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>啟動所有服務</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>檢查服務狀態</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker-compose</span> <span class="token function">ps</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<h2 id="資源管理與監控"><a href="#資源管理與監控" class="headerlink" title="資源管理與監控"></a>資源管理與監控</h2><h3 id="容器資源限制"><a href="#容器資源限制" class="headerlink" title="容器資源限制"></a>容器資源限制</h3><p>為了確保系統穩定性，我們需要為容器設定適當的資源限制：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># docker-compose.yml</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
      <span class="token key atrule">resources</span><span class="token punctuation">:</span>
        <span class="token key atrule">limits</span><span class="token punctuation">:</span>
          <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'0.5'</span>    <span class="token comment"># 限制最多使用 50% CPU</span>
          <span class="token key atrule">memory</span><span class="token punctuation">:</span> 512M   <span class="token comment"># 限制最大記憶體使用量</span>
        <span class="token key atrule">reservations</span><span class="token punctuation">:</span>
          <span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token string">'0.25'</span>   <span class="token comment"># 保證至少 25% CPU</span>
          <span class="token key atrule">memory</span><span class="token punctuation">:</span> 256M   <span class="token comment"># 保證最少記憶體</span>

  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
      <span class="token key atrule">resources</span><span class="token punctuation">:</span>
        <span class="token key atrule">limits</span><span class="token punctuation">:</span>
          <span class="token key atrule">memory</span><span class="token punctuation">:</span> 2G
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> sqlvolume<span class="token punctuation">:</span>/var/opt/mssql
    <span class="token key atrule">storage_opts</span><span class="token punctuation">:</span>
      <span class="token key atrule">size</span><span class="token punctuation">:</span> <span class="token string">'10G'</span>  <span class="token comment"># 限制容器儲存空間</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="監控工具設定"><a href="#監控工具設定" class="headerlink" title="監控工具設定"></a>監控工具設定</h3><h4 id="1-Portainer-安裝"><a href="#1-Portainer-安裝" class="headerlink" title="1. Portainer 安裝"></a>1. Portainer 安裝</h4><p>Portainer 提供了直覺的 Web 介面來管理 Docker 容器：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> volume create portainer_data
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">9000</span>:9000 <span class="token parameter variable">--name</span><span class="token operator">=</span>portainer <span class="token parameter variable">--restart</span><span class="token operator">=</span>always <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> portainer_data:/data <span class="token punctuation">\</span>
    portainer/portainer-ce<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>安裝完成後可以訪問 <a target="_blank" rel="noopener" href="http://localhost:9000/">http://localhost:9000</a> 進行設定。</p>
<h4 id="2-日誌管理"><a href="#2-日誌管理" class="headerlink" title="2. 日誌管理"></a>2. 日誌管理</h4><p>在 docker-compose.yml 中加入日誌設定：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">logging</span><span class="token punctuation">:</span>
      <span class="token key atrule">driver</span><span class="token punctuation">:</span> <span class="token string">"json-file"</span>
      <span class="token key atrule">options</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-size</span><span class="token punctuation">:</span> <span class="token string">"200m"</span>
        <span class="token key atrule">max-file</span><span class="token punctuation">:</span> <span class="token string">"10"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="開發環境設定"><a href="#開發環境設定" class="headerlink" title="開發環境設定"></a>開發環境設定</h2><h3 id="Hot-Reload-配置"><a href="#Hot-Reload-配置" class="headerlink" title="Hot Reload 配置"></a>Hot Reload 配置</h3><p>為了提升開發效率，我們可以設定 Hot Reload：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># docker-compose.override.yml</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> .<span class="token punctuation">:</span>/app
      <span class="token punctuation">-</span> /app/bin
      <span class="token punctuation">-</span> /app/obj
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ASPNETCORE_ENVIRONMENT=Development
      <span class="token punctuation">-</span> DOTNET_USE_POLLING_FILE_WATCHER=true
    <span class="token key atrule">entrypoint</span><span class="token punctuation">:</span> dotnet watch run

  <span class="token key atrule">frontend</span><span class="token punctuation">:</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./src<span class="token punctuation">:</span>/app/src
    <span class="token key atrule">command</span><span class="token punctuation">:</span> npm run dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Debug-設定"><a href="#Debug-設定" class="headerlink" title="Debug 設定"></a>Debug 設定</h3><p>在 VS Code 中設定容器除錯：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// .vscode/launch.json</span>
<span class="token punctuation">&#123;</span>
    <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Docker .NET Core Attach"</span><span class="token punctuation">,</span>
            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"coreclr"</span><span class="token punctuation">,</span>
            <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"attach"</span><span class="token punctuation">,</span>
            <span class="token property">"processName"</span><span class="token operator">:</span> <span class="token string">"YourProject"</span><span class="token punctuation">,</span>
            <span class="token property">"pipeTransport"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token property">"pipeProgram"</span><span class="token operator">:</span> <span class="token string">"docker"</span><span class="token punctuation">,</span>
                <span class="token property">"pipeArgs"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token string">"-i"</span><span class="token punctuation">,</span> <span class="token string">"api"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token property">"debuggerPath"</span><span class="token operator">:</span> <span class="token string">"/vsdbg/vsdbg"</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="網路配置"><a href="#網路配置" class="headerlink" title="網路配置"></a>網路配置</h2><h3 id="網路隔離"><a href="#網路隔離" class="headerlink" title="網路隔離"></a>網路隔離</h3><p>為了提高安全性，我們可以將服務分配到不同的網路：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># docker-compose.yml</span>
<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">frontend</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge
  <span class="token key atrule">backend</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge
    <span class="token key atrule">internal</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token comment"># 只允許內部存取</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> backend
      <span class="token punctuation">-</span> frontend
    
  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> backend

  <span class="token key atrule">frontend</span><span class="token punctuation">:</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> frontend<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="部署與維護"><a href="#部署與維護" class="headerlink" title="部署與維護"></a>部署與維護</h2><h3 id="CI-CD-整合"><a href="#CI-CD-整合" class="headerlink" title="CI/CD 整合"></a>CI/CD 整合</h3><p>以下是一個使用 GitHub Actions 的範例：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># .github/workflows/docker-publish.yml</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> Docker Build and Push

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> main <span class="token punctuation">]</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2
      
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Login to Docker Hub
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/login<span class="token punctuation">-</span>action@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">username</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.DOCKER_HUB_USERNAME <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
          <span class="token key atrule">password</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.DOCKER_HUB_ACCESS_TOKEN <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
          
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build and push
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/build<span class="token punctuation">-</span>push<span class="token punctuation">-</span>action@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">context</span><span class="token punctuation">:</span> .
          <span class="token key atrule">push</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
          <span class="token key atrule">tags</span><span class="token punctuation">:</span> user/myapp<span class="token punctuation">:</span>latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="環境變數管理"><a href="#環境變數管理" class="headerlink" title="環境變數管理"></a>環境變數管理</h3><p>建立不同環境的設定檔：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># .env.development</span>
<span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span>dev_password
<span class="token assign-left variable">API_URL</span><span class="token operator">=</span>http://localhost:5000

<span class="token comment"># .env.production</span>
<span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token variable">$&#123;PROD_DB_PASSWORD&#125;</span>
<span class="token assign-left variable">API_URL</span><span class="token operator">=</span>https://api.example.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="自動化部署腳本"><a href="#自動化部署腳本" class="headerlink" title="自動化部署腳本"></a>自動化部署腳本</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># deploy.sh</span>

<span class="token comment"># 拉取最新映像檔</span>
<span class="token function">docker-compose</span> pull

<span class="token comment"># 使用生產環境設定檔</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">COMPOSE_FILE</span><span class="token operator">=</span>docker-compose.yml:docker-compose.prod.yml

<span class="token comment"># 更新服務</span>
<span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span> --remove-orphans

<span class="token comment"># 清理舊映像檔</span>
<span class="token function">docker</span> image prune <span class="token parameter variable">-f</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="常見問題與解決方案"><a href="#常見問題與解決方案" class="headerlink" title="常見問題與解決方案"></a>常見問題與解決方案</h2><h3 id="1-SQL-Server-連線問題"><a href="#1-SQL-Server-連線問題" class="headerlink" title="1. SQL Server 連線問題"></a>1. SQL Server 連線問題</h3><ul>
<li>確認連線字串中的主機名稱使用服務名稱 (db)</li>
<li>確認 SA 密碼符合複雜度要求</li>
<li>檢查防火牆設定</li>
</ul>
<h3 id="2-NET-Core-API-容器化問題"><a href="#2-NET-Core-API-容器化問題" class="headerlink" title="2. .NET Core API 容器化問題"></a>2. .NET Core API 容器化問題</h3><ul>
<li>確保 Dockerfile 中的專案名稱正確</li>
<li>檢查 ASPNETCORE_URLS 環境變數設定</li>
<li>確認 API 監聽的埠號設定</li>
</ul>
<h3 id="3-Vue3-建置問題"><a href="#3-Vue3-建置問題" class="headerlink" title="3. Vue3 建置問題"></a>3. Vue3 建置問題</h3><ul>
<li>確保 node_modules 已被正確忽略</li>
<li>檢查 nginx 設定是否正確</li>
<li>確認環境變數檔案 (.env) 設定</li>
</ul>
<h3 id="4-效能優化相關"><a href="#4-效能優化相關" class="headerlink" title="4. 效能優化相關"></a>4. 效能優化相關</h3><h4 id="映像檔優化"><a href="#映像檔優化" class="headerlink" title="映像檔優化"></a>映像檔優化</h4><ul>
<li>使用多階段建置減少映像檔大小</li>
<li>選用 alpine 版本的基礎映像檔</li>
<li>適當使用 .dockerignore 排除不必要檔案</li>
</ul>
<h4 id="容器效能優化"><a href="#容器效能優化" class="headerlink" title="容器效能優化"></a>容器效能優化</h4><ul>
<li>設定適當的記憶體和 CPU 限制</li>
<li>使用 Volume 而非 bind mount</li>
<li>定期清理未使用的容器和映像檔</li>
</ul>
<h4 id="網路效能"><a href="#網路效能" class="headerlink" title="網路效能"></a>網路效能</h4><ul>
<li>使用內部網路進行容器間通訊</li>
<li>合理設計網路拓撲</li>
<li>需要時使用 DNS 快取</li>
</ul>
<h2 id="安全性建議"><a href="#安全性建議" class="headerlink" title="安全性建議"></a>安全性建議</h2><p>除了之前提到的最佳實踐外，還要注意：</p>
<h3 id="容器安全"><a href="#容器安全" class="headerlink" title="容器安全"></a>容器安全</h3><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">security_opt</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> no<span class="token punctuation">-</span>new<span class="token punctuation">-</span>privileges<span class="token punctuation">:</span><span class="token boolean important">true</span>
    <span class="token key atrule">read_only</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">tmpfs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /tmp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="機密管理"><a href="#機密管理" class="headerlink" title="機密管理"></a>機密管理</h3><p>使用 Docker Secrets：</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">api</span><span class="token punctuation">:</span>
    <span class="token key atrule">secrets</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db_password

<span class="token key atrule">secrets</span><span class="token punctuation">:</span>
  <span class="token key atrule">db_password</span><span class="token punctuation">:</span>
    <span class="token key atrule">file</span><span class="token punctuation">:</span> ./secrets/db_password.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="最佳實踐建議"><a href="#最佳實踐建議" class="headerlink" title="最佳實踐建議"></a>最佳實踐建議</h2><ol>
<li><p>映像檔優化</p>
<ul>
<li>使用多階段建置減少映像檔大小</li>
<li>善用 .dockerignore 排除不必要檔案</li>
<li>選擇適當的基礎映像檔</li>
</ul>
</li>
<li><p>安全性考量</p>
<ul>
<li>不要在映像檔中存儲敏感資訊</li>
<li>定期更新基礎映像檔</li>
<li>使用非 root 使用者運行容器</li>
</ul>
</li>
<li><p>開發流程</p>
<ul>
<li>使用 docker-compose.override.yml 管理開發環境設定</li>
<li>實作健康檢查機制</li>
<li>建立完整的 CI/CD 流程</li>
</ul>
</li>
</ol>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>透過本文的說明，我們完成了一個完整的 Docker 容器化環境設定，包含了 SQL Server 資料庫、.NET Core API 後端和 Vue3 前端。這樣的架構不僅方便開發和測試，也便於部署和擴展。</p>
<p>記得定期備份資料，並持續優化容器配置以提升效能和安全性。若有任何問題，歡迎參考 Docker 官方文件或社群資源尋求協助。</p>
<h2 id="參考資源"><a href="#參考資源" class="headerlink" title="參考資源"></a>參考資源</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/">Docker 官方文件</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-tw/sql/linux/quickstart-install-connect-docker">Microsoft SQL Server Docker 指南</a></li>
<li><a target="_blank" rel="noopener" href="https://v3.vuejs.org/guide/deployment.html#docker-nginx">Vue.js Docker 部署指南</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-tw/dotnet/core/docker/build-container">.NET Core Docker 指南</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">kyosora</p>
  <div class="site-description" itemprop="description">個人技術筆記和學習心得分享</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">99</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">分類</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">118</span>
        <span class="site-state-item-name">標籤</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kyosora</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 強力驅動
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
